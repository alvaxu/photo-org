<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <!-- Edgeæµè§ˆå™¨å…¼å®¹æ€§ä¿®å¤ -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="msapplication-TileColor" content="#0d6efd">
    <meta name="theme-color" content="#0d6efd">
    <title>å®¶åº­ç‰ˆæ™ºèƒ½ç…§ç‰‡ç³»ç»Ÿ</title>

    <!-- Bootstrap CSS - ä¼˜å…ˆä½¿ç”¨æœ¬åœ°ç‰ˆæœ¬ -->
    <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="lib/bootstrap-icons/css/bootstrap-icons.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons å­—ä½“ä¿®å¤ -->
    <style>
        @font-face {
            font-display: block;
            font-family: "bootstrap-icons";
            src: url("lib/bootstrap-icons/fonts/bootstrap-icons.woff2?2ab2cbbe07fcebb53bdaa7313bb290f2") format("woff2"),
                 url("lib/bootstrap-icons/fonts/bootstrap-icons.woff?2ab2cbbe07fcebb53bdaa7313bb290f2") format("woff");
        }
    </style>
    
    <!-- CDNå¤‡ç”¨åŠ è½½ -->
    <script>
        // å¦‚æœæœ¬åœ°èµ„æºåŠ è½½å¤±è´¥ï¼Œå°è¯•CDN
        setTimeout(function() {
            const links = document.querySelectorAll('link[href*="lib/"]');
            links.forEach(link => {
                if (!link.sheet) {
                    console.warn('æœ¬åœ°èµ„æºåŠ è½½å¤±è´¥ï¼Œå°è¯•CDN:', link.href);
                    if (link.href.includes('bootstrap.min.css')) {
                        link.href = 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css';
                    } else if (link.href.includes('bootstrap-icons.min.css')) {
                        link.href = 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css';
                    }
                }
            });
        }, 2000);
    </script>
    

    <!-- è‡ªå®šä¹‰æ ·å¼ -->
    <link href="css/style.css?v=20250120_01" rel="stylesheet">
    <link href="css/search-multiselect.css?v=20250120_01" rel="stylesheet">
    
    <!-- åœ°ç†ç¼–ç æœåŠ¡é€‰æ‹©æ ·å¼ -->
    <style>
        .service-options {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }

        .service-option {
            flex: 1;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .service-option:hover {
            border-color: #007bff;
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        }

        .service-option.selected {
            border-color: #007bff;
            background-color: #f8f9ff;
        }

        .service-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .service-icon {
            font-size: 24px;
        }

        .service-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .service-badge.online {
            background-color: #28a745;
            color: white;
        }

        .service-badge.offline {
            background-color: #6c757d;
            color: white;
        }

        .service-description ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .service-description li {
            margin: 5px 0;
            font-size: 14px;
        }

        .service-status {
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #dc3545;
        }

        .status-indicator.ready {
            background-color: #28a745;
        }

        .status-indicator.checking {
            background-color: #ffc107;
            animation: pulse 1s infinite;
        }

        .status-indicator.error {
            background-color: #dc3545;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .help-text {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-size: 14px;
        }

        .help-text p {
            margin: 5px 0;
        }
    </style>
    <link href="css/slideshow-player.css?v=20250120_01" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="images/xuwh.ico">
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img src="images/xuwh.ico" alt="æ™ºèƒ½ç…§ç‰‡ç³»ç»Ÿ" class="me-2" style="width: 32px; height: 32px;">
                æ™ºèƒ½ç…§ç‰‡ç³»ç»Ÿ
                <small class="ms-2 text-light opacity-75">2025-V5.1.8ç‰ˆ</small>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#photos" id="navPhotos" data-section="photos">
                            <i class="bi bi-grid-3x3-gap"></i> ç…§ç‰‡åº“
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/startup-info" id="navStartupInfo" title="æ˜¾ç¤ºæ‰‹æœºè®¿é—®äºŒç»´ç ï¼Œæ–¹ä¾¿æ‰‹æœºæ‰«æå¿«é€Ÿè¿æ¥">
                            <i class="bi bi-qr-code-scan"></i> æ‰‹æœºè®¿é—®
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/settings" id="navSettings" data-section="settings">
                            <i class="bi bi-gear"></i> ç³»ç»Ÿé…ç½®
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/help-overview" id="navHelp" data-section="help" target="_blank">
                            <i class="bi bi-info-circle"></i> åŠŸèƒ½è¯´æ˜
                        </a>
                    </li>
                </ul>

                <div class="d-flex">
                    <button class="btn btn-outline-light me-2" id="importBtn" data-bs-toggle="modal" data-bs-target="#importModal" title="å¯¼å…¥ç…§ç‰‡åˆ°ç³»ç»Ÿä¸­ï¼Œæ”¯æŒå•æ–‡ä»¶æˆ–æ‰¹é‡å¯¼å…¥">
                        <i class="bi bi-upload"></i> å¯¼å…¥ç…§ç‰‡
                    </button>
                    <button class="btn btn-outline-light me-2" id="basicAnalysisBtn" title="å¯¹ç…§ç‰‡è¿›è¡ŒåŸºç¡€åˆ†æï¼ŒåŒ…æ‹¬è´¨é‡è¯„ä¼°ã€EXIFä¿¡æ¯æå–ã€ç”ŸæˆèŠ‚å‡æ—¥æ ‡ç­¾ç­‰ï¼Œæ— éœ€å¤§æ¨¡å‹">
                        <i class="bi bi-graph-up-arrow"></i> åŸºç¡€åˆ†æ
                    </button>
                    <button class="btn btn-outline-light me-2" id="imageFeatureExtractionBtn" title="æå–ç…§ç‰‡çš„æ·±åº¦ç‰¹å¾å‘é‡ï¼Œç”¨äºç²¾ç¡®çš„ç›¸ä¼¼ç…§ç‰‡æœç´¢ï¼ŒåŸºäºResNet50æ¨¡å‹">
                        <i class="bi bi-image"></i> ç‰¹å¾æå–
                    </button>
                    <a class="btn btn-outline-light me-2" href="/people" id="navPeople" data-section="people" title="æ£€æµ‹ç…§ç‰‡ä¸­çš„äººè„¸å¹¶è¿›è¡Œèšç±»è¯†åˆ«ï¼Œæ”¯æŒäººç‰©ç®¡ç†å’Œæ ‡è®°">
                        <i class="bi bi-people"></i> äººè„¸è¯†åˆ«
                    </a>
                    <button class="btn btn-outline-light me-2" id="gpsToAddressBtn" title="æ‰¹é‡å°†ç…§ç‰‡çš„GPSåæ ‡è½¬æ¢ä¸ºåœ°å€ä¿¡æ¯ï¼Œæ”¯æŒå¤šç§åœ°å€è§£ææœåŠ¡">
                        <i class="bi bi-geo-alt"></i> GPSè½¬åœ°å€
                    </button>
                    <button class="btn btn-outline-light me-2" id="aiAnalysisBtn" title="ä½¿ç”¨AIå¯¹ç…§ç‰‡è¿›è¡Œæ·±åº¦åˆ†æï¼Œç”Ÿæˆå†…å®¹æè¿°ã€æ™ºèƒ½åˆ†ç±»å’ŒAIæ ‡ç­¾ï¼Œéœ€è¦é…ç½®APIå¯†é’¥">
                        <i class="bi bi-robot"></i> AIåˆ†æ(å¯é€‰)
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="container-fluid mt-4">
        <!-- æœç´¢å’Œç­›é€‰æ  -->
        <div class="row mb-4" id="searchFilterPanel">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center flex-grow-1">
                            <h6 class="mb-0 me-3">
                                <i class="bi bi-search me-1"></i>ç­›é€‰ä¸æ’åº
                            </h6>
                            <!-- ç­›é€‰çŠ¶æ€æ˜¾ç¤ºï¼ˆç§»åˆ°headerï¼‰ -->
                            <div class="ms-3" id="filterStatus" style="display: none;">
                                <i class="bi bi-funnel me-2 text-info"></i>
                                <span id="filterStatusText" class="text-muted">å½“å‰ç­›é€‰æ¡ä»¶ï¼š</span>
                                <button class="btn btn-sm btn-outline-danger ms-2" id="clearFiltersSmall">
                                    <i class="bi bi-x-circle me-1"></i>æ¸…é™¤ç­›é€‰
                                </button>
                            </div>
                        </div>
                        <button class="btn btn-sm btn-outline-primary" id="searchFilterToggle">
                            <i class="bi bi-chevron-down" id="searchFilterToggleIcon"></i>
                            ç‚¹å‡»å±•å¼€
                        </button>
                    </div>
                    
                    <!-- å¯æŠ˜å çš„å†…å®¹åŒºåŸŸ -->
                    <div class="collapse" id="searchFilterContent">
                    <div class="card-body">
                        <!-- åˆ—æ¨¡å¼å¸ƒå±€ï¼šç¬¬ä¸€åˆ—å¿«é€Ÿæœç´¢ï¼Œç¬¬äºŒåˆ—ç­›é€‰æ¡ä»¶ -->
                        <div class="row">
                            <!-- ç¬¬ä¸€åˆ—ï¼šå¿«é€Ÿæœç´¢ -->
                            <div class="col-lg-4 col-md-12 mb-3 mb-lg-0">
                                <!-- ç¬¬ä¸€è¡Œï¼šæœç´¢æ ‡é¢˜ -->
                                <div class="mb-3 d-flex justify-content-between align-items-center">
                                    <label class="form-label fw-bold text-primary mb-0">
                                        <i class="bi bi-search me-1"></i>å¿«é€Ÿæœç´¢
                                    </label>
                                    <button class="btn btn-sm btn-outline-info" onclick="toggleSearchHelp()">
                                        <i class="bi bi-question-circle"></i> æœç´¢æŠ€å·§
                                    </button>
                                </div>
                                
                                <!-- ç¬¬äºŒè¡Œï¼šæœç´¢è¾“å…¥æ¡† -->
                                <div class="mb-3">
                                    <div class="input-group">
                                        <select class="form-select" id="searchType" style="max-width: 100px;" title="é€‰æ‹©æœç´¢èŒƒå›´">
                                            <option value="all">å…¨éƒ¨å†…å®¹</option>
                                            <option value="filename">æ–‡ä»¶å</option>
                                            <option value="description">ç”¨æˆ·æè¿°</option>
                                            <option value="address">æ‹æ‘„åœ°å€</option>
                                            <option value="ai_analysis">AIåˆ†æç»“æœ</option>
                                        </select>
                                        <input type="text" class="form-control" id="searchInput" 
                                               placeholder="è¾“å…¥å…³é”®è¯æœç´¢..." 
                                               data-bs-toggle="tooltip" 
                                               data-bs-placement="bottom" 
                                               title="">
                                        <button class="btn btn-primary" type="button" id="searchBtn">
                                            <i class="bi bi-search"></i>
                                        </button>
                                    </div>
                                </div>

                                <!-- ç¬¬ä¸‰è¡Œï¼šæœç´¢èŒƒå›´æç¤º -->
                                <div class="mb-3">
                                    <small class="text-muted" id="searchScopeHint">
                                        <i class="bi bi-info-circle me-1"></i>
                                        <!-- å†…å®¹å°†ç”±JavaScriptåŠ¨æ€è®¾ç½® -->
                                    </small>
                                </div>
                            </div>
                            
                            <!-- ç¬¬äºŒåˆ—ï¼šç­›é€‰æ¡ä»¶ -->
                            <div class="col-lg-8 col-md-12">
                                <!-- ç­›é€‰æ¡ä»¶åŒºåŸŸ -->
                                <div class="row mb-3">
                                    <!-- æ ‡ç­¾ç­›é€‰ -->
                                    <div class="col-6 col-lg-3 mb-3 mb-lg-0" id="tagFilter">
                                        <label class="form-label">æ ‡ç­¾ç­›é€‰</label>
                                        <div class="dropdown">
                                            <button class="btn btn-outline-secondary dropdown-toggle w-100" type="button" data-bs-toggle="dropdown">
                                                <span id="tagFilterText">é€‰æ‹©æ ‡ç­¾</span>
                                            </button>
                                            <div class="dropdown-menu w-100" style="max-height: 200px; overflow-y: auto;">
                                                <div class="px-3 py-2">
                                                    <input type="text" class="form-control form-control-sm" id="tagSearchInput" placeholder="æœç´¢æ ‡ç­¾...">
                                                </div>
                                                <div class="dropdown-divider"></div>
                                                <div class="px-3" id="tagOptions">
                                                    <!-- æ ‡ç­¾é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- åˆ†ç±»ç­›é€‰ -->
                                    <div class="col-6 col-lg-3 mb-3 mb-lg-0" id="categoryFilter">
                                        <label class="form-label">åˆ†ç±»ç­›é€‰</label>
                                        <div class="dropdown">
                                            <button class="btn btn-outline-secondary dropdown-toggle w-100" type="button" data-bs-toggle="dropdown">
                                                <span id="categoryFilterText">é€‰æ‹©åˆ†ç±»</span>
                                            </button>
                                            <div class="dropdown-menu w-100" style="max-height: 200px; overflow-y: auto;">
                                                <div class="px-3 py-2">
                                                    <input type="text" class="form-control form-control-sm" id="categorySearchInput" placeholder="æœç´¢åˆ†ç±»...">
                                                </div>
                                                <div class="dropdown-divider"></div>
                                                <div class="px-3" id="categoryOptions">
                                                    <!-- åˆ†ç±»é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- åŸºç¡€ç­›é€‰ï¼ˆåŠ¨æ€åˆ‡æ¢ï¼‰ -->
                                    <div class="col-6 col-lg-3 mb-3 mb-lg-0">
                                        <label class="form-label">åŸºç¡€ç­›é€‰</label>
                                        <div class="d-flex gap-2">
                                            <!-- ç­›é€‰æ¨¡å¼é€‰æ‹©å™¨ -->
                                            <select class="form-select" id="advancedFilterMode" style="flex: 0 0 120px;">
                                                <option value="date" selected>ğŸ“… æ—¥æœŸ</option>
                                                <option value="quality">â­ è´¨é‡</option>
                                                <option value="face_count">ğŸ‘¥ äººæ•°</option>
                                                <option value="format">ğŸ“„ æ ¼å¼</option>
                                                <option value="camera">ğŸ“· ç›¸æœº</option>
                                            </select>

                                            <!-- ç­›é€‰é€‰é¡¹å®¹å™¨ -->
                                            <div id="advancedFilterOptions" style="flex: 1;">
                                                <!-- ç­›é€‰é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                                            </div>
                                        </div>
                                    </div>

                                    <!-- æ’åºæ–¹å¼ -->
                                    <div class="col-6 col-lg-3">
                                        <label class="form-label">æ’åºæ–¹å¼</label>
                                        <div class="d-flex gap-1">
                                            <select class="form-select" id="sortBy" style="flex: 2;">
                                                <option value="taken_at" selected>æ‹æ‘„æ—¶é—´</option>
                                                <option value="quality_score">è´¨é‡åˆ†æ•°</option>
                                                <option value="created_at">å¯¼å…¥æ—¶é—´</option>
                                                <option value="filename">æ–‡ä»¶å</option>
                                                <option value="file_size">æ–‡ä»¶å¤§å°</option>
                                            </select>
                                            <select class="form-select" id="sortOrder" style="flex: 1;">
                                                <option value="desc" selected>é™åº</option>
                                                <option value="asc">å‡åº</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- æœç´¢å»ºè®®å®¹å™¨ -->
                        <div id="searchSuggestions" class="mt-2" style="display: none;">
                            <div class="d-flex flex-wrap gap-1"></div>
                            </div>

                        <!-- è‡ªå®šä¹‰æ—¥æœŸèŒƒå›´ -->
                        <div class="row mb-3" id="customDateRange" style="display: none;">
                            <div class="col-md-2"></div>
                            <div class="col-md-2">
                                <label class="form-label">å¼€å§‹æ—¥æœŸ</label>
                                <input type="date" class="form-control" id="startDate">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">ç»“æŸæ—¥æœŸ</label>
                                <input type="date" class="form-control" id="endDate">
                            </div>
                        </div>
                                </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æŒ‰è‚–åƒç­›é€‰é¢æ¿ -->
        <div class="row mb-3" id="portraitFilterPanel">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <h6 class="mb-0 me-3">
                                <i class="bi bi-person-circle me-1"></i>
                                æŒ‰äººè„¸ç­›é€‰
                            </h6>
                            <!-- äººç‰©ç»Ÿè®¡ä¿¡æ¯ï¼ˆå§‹ç»ˆæ˜¾ç¤ºï¼‰ -->
                            <div class="d-flex align-items-center gap-3">
                                <div class="stat-item">
                                    <span class="stat-number" id="totalPeopleCount">-</span>
                                    <span class="stat-label">æ€»äººç‰©</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number" id="labeledPeopleCount">-</span>
                                    <span class="stat-label">å·²æ ‡è®°</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number" id="unlabeledPeopleCount">-</span>
                                    <span class="stat-label">æœªæ ‡è®°</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number" id="totalFacesCount">-</span>
                                    <span class="stat-label">æ€»äººè„¸</span>
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-sm btn-outline-secondary" id="portraitFilterToggle">
                            <i class="bi bi-chevron-down"></i>
                            ç‚¹å‡»å±•å¼€
                        </button>
                    </div>
                    
                    <!-- è‚–åƒé€‰æ‹©åŒºåŸŸï¼ˆå¯å±•å¼€ï¼‰ -->
                    <div class="card-body collapse" id="portraitFilterContent">
                        <div class="row g-2" id="portraitFilterGrid">
                            <!-- åŠ¨æ€åŠ è½½çš„è‚–åƒå¡ç‰‡ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç»Ÿè®¡ä¿¡æ¯é¢æ¿ -->
        <div class="row mb-3" id="photoStatsPanel">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <h6 class="mb-0 me-3">
                                <i class="bi bi-bar-chart me-1"></i>
                               æŒ‰ç»Ÿè®¡å›¾ç­›é€‰
                            </h6>
                            <div class="stats-header-icons" id="statsHeaderIcons">
                                <!-- ç»Ÿè®¡å›¾æ ‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                        </div>
                        <button class="btn btn-sm btn-outline-primary" id="toggleStatsPanel">
                            <i class="bi bi-chevron-down" id="statsToggleIcon"></i>
                            ç‚¹å‡»å±•å¼€
                        </button>
                    </div>

                    <!-- å¯æŠ˜å çš„ç»Ÿè®¡é¢æ¿ -->
                    <div class="collapse" id="statsPanel">
                        <div class="card-body">
                            <!-- å›¾è¡¨åŒºåŸŸ -->
                            <!-- ç¬¬ä¸€è¡Œï¼šäººè„¸æ•°åˆ†å¸ƒå’Œå¹´åº¦åˆ†å¸ƒ -->
                            <div class="row mb-4">
                                <div class="col-md-6 mb-4">
                                    <div class="card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h6 class="mb-0">äººè„¸æ•°åˆ†å¸ƒ</h6>
                                            <button class="btn btn-sm btn-outline-secondary" onclick="statsPanel.filterByFaceCount('all')">
                                                æŸ¥çœ‹å…¨éƒ¨
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <div class="stats-chart-container">
                                                <canvas id="faceCountChart"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-4">
                                    <div class="card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h6 class="mb-0">å¹´åº¦åˆ†å¸ƒ</h6>
                                            <button class="btn btn-sm btn-outline-secondary" onclick="statsPanel.filterByYear('all')">
                                                æŸ¥çœ‹å…¨éƒ¨
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <div class="stats-chart-container">
                                                <canvas id="yearChart"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ç¬¬äºŒè¡Œï¼šè´¨é‡åˆ†å¸ƒã€æ ¼å¼åˆ†å¸ƒå’Œç›¸æœºåˆ†å¸ƒ -->
                            <div class="row">
                                <div class="col-md-4 mb-4">
                                    <div class="card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h6 class="mb-0">è´¨é‡åˆ†å¸ƒ</h6>
                                            <button class="btn btn-sm btn-outline-secondary" onclick="statsPanel.filterByQuality('all')">
                                                æŸ¥çœ‹å…¨éƒ¨
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <div class="stats-chart-container">
                                                <canvas id="qualityChart"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <div class="card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h6 class="mb-0">æ ¼å¼åˆ†å¸ƒ</h6>
                                            <button class="btn btn-sm btn-outline-secondary" onclick="statsPanel.filterByFormat('all')">
                                                æŸ¥çœ‹å…¨éƒ¨
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <div id="formatList" class="stats-chart-container">
                                                <!-- æ ¼å¼åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <div class="card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h6 class="mb-0">ç›¸æœºåˆ†å¸ƒ</h6>
                                            <button class="btn btn-sm btn-outline-secondary" onclick="statsPanel.filterByCamera('all')">
                                                æŸ¥çœ‹å…¨éƒ¨
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <div id="cameraList" class="stats-chart-container">
                                                <!-- ç›¸æœºåˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- ç…§ç‰‡å±•ç¤ºåŒºåŸŸ -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <!-- å·¦ä¾§æ’­æ”¾æŒ‰é’®ç»„ -->
                        <div class="d-flex align-items-center gap-2">
                            <button class="btn btn-sm btn-success" id="slideshowAllBtn">
                                <i class="bi bi-play-circle-fill me-1"></i>æ’­æ”¾å…¨éƒ¨
                            </button>
                            <button class="btn btn-sm btn-success" id="slideshowSelectedBtn" disabled>
                                <i class="bi bi-play-circle me-1"></i>æ’­æ”¾é€‰ä¸­
                            </button>
                        </div>

                        <!-- ä¸­é—´æ ‡é¢˜å’Œè§†å›¾æ¨¡å¼ -->
                        <div class="flex-grow-1 text-center d-flex align-items-center justify-content-center gap-3">
                            <h5 class="mb-0">
                                <i class="bi bi-images me-2"></i>
                                ç…§ç‰‡åº“
                                <small class="text-muted ms-2">
                                    <span id="photoCount">0</span> å¼ ç…§ç‰‡
                                </small>
                            </h5>
                            <!-- è§†å›¾æ¨¡å¼æŒ‰é’® -->
                            <div class="btn-group" role="group">
                                <input type="radio" class="btn-check" name="viewMode" id="gridView" autocomplete="off" checked>
                                <label class="btn btn-outline-secondary btn-sm" for="gridView">
                                    <i class="bi bi-grid-3x3-gap"></i>
                                </label>
                                <input type="radio" class="btn-check" name="viewMode" id="listView" autocomplete="off">
                                <label class="btn btn-outline-secondary btn-sm" for="listView">
                                    <i class="bi bi-list"></i>
                                </label>
                            </div>
                        </div>

                        <!-- å³ä¾§æ“ä½œæŒ‰é’® -->
                        <div class="d-flex align-items-center">
                            <!-- æ“ä½œæŒ‰é’® -->
                            <div class="btn-group" role="group">
                                <button class="btn btn-sm btn-outline-secondary" id="selectAllBtn">å…¨é€‰</button>
                                <button class="btn btn-sm btn-outline-secondary" id="clearSelectionBtn">å–æ¶ˆé€‰æ‹©</button>
                                <button class="btn btn-sm btn-outline-danger" id="deleteSelectedBtn" disabled>
                                    <i class="bi bi-trash"></i> åˆ é™¤é€‰ä¸­
                                </button>
                                <button class="btn btn-sm btn-outline-primary" id="batchEditBtn" disabled>
                                    <i class="bi bi-pencil-square"></i> æ‰¹é‡ç¼–è¾‘
                                </button>
                                <button class="btn btn-sm btn-warning" id="basicProcessSelectedBtn" disabled>
                                    <i class="bi bi-graph-up-arrow"></i> åŸºç¡€åˆ†æ
                                </button>
                                <button class="btn btn-sm btn-primary" id="aiProcessSelectedBtn" disabled>
                                    <i class="bi bi-robot"></i> AIåˆ†æ
                                </button>
                                <button class="btn btn-sm btn-success" id="downloadSelectedBtn" disabled>
                                    <i class="bi bi-download"></i> ä¸‹è½½é€‰ä¸­
                                </button>
                                <button class="btn btn-sm btn-outline-info" id="photoDisplayHelpBtn" onclick="togglePhotoDisplayHelp()">
                                    <i class="bi bi-question-circle"></i> å¸®åŠ©
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- åŠ è½½çŠ¶æ€ -->
                        <div id="loadingIndicator" class="text-center py-5">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">åŠ è½½ä¸­...</span>
                            </div>
                            <p class="mt-3 text-muted">æ­£åœ¨åŠ è½½ç…§ç‰‡...</p>
                        </div>

                        <!-- ç©ºçŠ¶æ€ -->
                        <div id="emptyState" class="text-center py-5 d-none">
                            <i class="bi bi-images display-1 text-muted"></i>
                            <h4 class="mt-3 text-muted">æš‚æ— ç…§ç‰‡</h4>
                            <p class="text-muted">è¯·å…ˆå¯¼å…¥ä¸€äº›ç…§ç‰‡å¼€å§‹ä½¿ç”¨</p>
                            <button class="btn btn-primary" id="importFirstBtn">
                                <i class="bi bi-upload me-2"></i>å¯¼å…¥ç¬¬ä¸€å¼ ç…§ç‰‡
                            </button>
                        </div>

                        <!-- ç…§ç‰‡ç½‘æ ¼å®¹å™¨ -->
                        <div id="photosGrid" class="row g-3">
                            <!-- ç…§ç‰‡å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </div>

                        <!-- åˆ†é¡µä¿¡æ¯ -->
                        <div id="paginationInfo" class="mt-4 d-none">
                            <div class="row">
                                <div class="col-md-6">
                                    <small class="text-muted" id="paginationText">
                                        <!-- åˆ†é¡µä¿¡æ¯å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                                    </small>
                                </div>
                                <div class="col-md-6 text-end">
                                    <small class="text-muted">
                                        æ¯é¡µæ˜¾ç¤º <span id="pageSize">12</span> å¼ ç…§ç‰‡
                                    </small>
                                </div>
                            </div>
                        </div>

                        <!-- åˆ†é¡µ -->
                        <div id="paginationContainer" class="mt-2 d-none">
                            <nav aria-label="ç…§ç‰‡åˆ†é¡µ">
                                <ul class="pagination justify-content-center" id="pagination">
                                    <!-- åˆ†é¡µæŒ‰é’®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ç…§ç‰‡è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div class="modal fade" id="photoModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="photoModalTitle">ç…§ç‰‡è¯¦æƒ…</h5>
                    <div class="d-flex align-items-center gap-2">
                        <button type="button" class="btn btn-sm btn-outline-primary" id="downloadPhotoBtn">
                            <i class="bi bi-download"></i>
                        </button>
                        <button type="button" class="btn btn-sm btn-outline-secondary" id="editPhotoBtn">
                            <i class="bi bi-pencil"></i>
                        </button>
                        <button type="button" class="btn btn-sm btn-outline-success" id="addToFavoritesBtn">
                            <i class="bi bi-heart"></i>
                        </button>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                </div>
                <div class="modal-body">
                    <!-- ç…§ç‰‡è¯¦æƒ…å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <!-- ç…§ç‰‡ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div class="modal fade" id="photoEditModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="photoEditModalTitle">ç¼–è¾‘ç…§ç‰‡</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="photoEditForm">
                        <input type="hidden" id="editPhotoId" value="">
                        
                        <!-- ç…§ç‰‡é¢„è§ˆ -->
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <img id="editPhotoPreview" src="" class="img-fluid rounded" alt="ç…§ç‰‡é¢„è§ˆ">
                            </div>
                            <div class="col-md-8">
                                <p class="text-muted" id="editPhotoMeta">å…ƒæ•°æ®ä¿¡æ¯</p>
                            </div>
                        </div>
                        
                        <!-- æ–‡ä»¶åç¼–è¾‘ -->
                        <div class="mb-3">
                            <label for="editPhotoFilename" class="form-label">ç…§ç‰‡æ–‡ä»¶å</label>
                            <input type="text" class="form-control" id="editPhotoFilename" 
                                   placeholder="è¯·è¾“å…¥ç…§ç‰‡æ–‡ä»¶å...">
                            <div class="form-text">ä¿®æ”¹æ–‡ä»¶åä¸ä¼šæ”¹å˜ç‰©ç†æ–‡ä»¶ï¼Œåªæ›´æ–°æ•°æ®åº“è®°å½•</div>
                        </div>
                        
                        <!-- æ‹æ‘„æ—¶é—´ç¼–è¾‘ -->
                        <div class="mb-3">
                            <label for="editPhotoTakenAt" class="form-label">æ‹æ‘„æ—¶é—´</label>
                            <input type="datetime-local" class="form-control" id="editPhotoTakenAt">
                            <div class="form-text">å¯ç”¨äºä¿®æ­£EXIFæå–é”™è¯¯æˆ–è¡¥å……ç¼ºå¤±çš„æ‹æ‘„æ—¶é—´</div>
                        </div>
                        
                        <!-- ä½ç½®åç§°ç¼–è¾‘ -->
                        <div class="mb-3">
                            <label for="editPhotoLocationName" class="form-label">ä½ç½®åç§°</label>
                            <input type="text" class="form-control" id="editPhotoLocationName" 
                                   placeholder="è¯·è¾“å…¥ä½ç½®åç§°...">
                            <div class="form-text">å¯ç”¨äºä¿®æ­£GPSè§£æçš„ä½ç½®åç§°æˆ–æ‰‹åŠ¨æ·»åŠ ä½ç½®ä¿¡æ¯</div>
                        </div>
                        
                        <!-- æè¿°ç¼–è¾‘ -->
                        <div class="mb-3">
                            <label for="editPhotoDescription" class="form-label">ç”¨æˆ·ç…§ç‰‡æè¿°</label>
                            <textarea class="form-control" id="editPhotoDescription" rows="3" 
                                    placeholder="è¯·è¾“å…¥ç”¨æˆ·ç…§ç‰‡æè¿°..."></textarea>
                        </div>
                        
                        <!-- æ ‡ç­¾ç¼–è¾‘ -->
                        <div class="mb-3">
                            <label for="editPhotoTags" class="form-label">æ ‡ç­¾</label>
                            <div class="d-flex gap-2">
                                <input type="text" class="form-control" id="editPhotoTags" 
                                       placeholder="è¾“å…¥æ ‡ç­¾åç§°...">
                                <button type="button" class="btn btn-outline-primary btn-sm" id="addTagBtn">
                                    <i class="bi bi-plus"></i> æ·»åŠ 
                                </button>
                            </div>
                            <div class="mt-2">
                                <div id="selectedTags" class="d-flex flex-wrap gap-1">
                                    <!-- é€‰ä¸­çš„æ ‡ç­¾å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                                </div>
                            </div>
                            <div class="form-text">è¾“å…¥æ ‡ç­¾åç§°åç‚¹å‡»"æ·»åŠ "æŒ‰é’®ï¼Œæˆ–ä»ä¸‹æ–¹é€‰æ‹©å·²æœ‰æ ‡ç­¾</div>
                        </div>
                        
                        <!-- å·²æœ‰æ ‡ç­¾é€‰æ‹© -->
                        <div class="mb-3">
                            <label class="form-label">é€‰æ‹©å·²æœ‰æ ‡ç­¾</label>
                            <div id="availableTags" class="d-flex flex-wrap gap-1">
                                <!-- å¯ç”¨æ ‡ç­¾å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                        </div>
                        
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" id="savePhotoEdit">ä¿å­˜ä¿®æ”¹</button>
                </div>
            </div>
        </div>
    </div>

    <!-- æ‰¹é‡ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div class="modal fade" id="batchEditModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">æ‰¹é‡ç¼–è¾‘ç…§ç‰‡</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info mb-3">
                        <i class="bi bi-info-circle me-1"></i>
                        <span id="batchEditSelectedCount">å·²é€‰æ‹© 0 å¼ ç…§ç‰‡</span>
                    </div>

                    <form id="batchEditForm">
                        <!-- æ ‡ç­¾æ“ä½œ -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">æ ‡ç­¾æ“ä½œ</label>
                            <div class="mb-2">
                                <select class="form-select" id="batchEditTagsOperation">
                                    <option value="">ä¸ä¿®æ”¹æ ‡ç­¾</option>
                                    <option value="add">è¿½åŠ æ ‡ç­¾</option>
                                    <option value="remove">ç§»é™¤æ ‡ç­¾</option>
                                    <option value="replace">æ›¿æ¢æ‰€æœ‰æ ‡ç­¾</option>
                                    <option value="clear">æ¸…ç©ºæ‰€æœ‰æ ‡ç­¾</option>
                                </select>
                            </div>
                            <div id="batchEditTagsInput" style="display: none;">
                                <div class="d-flex gap-2 mb-2">
                                    <input type="text" class="form-control" id="batchEditTags" 
                                           placeholder="è¾“å…¥æ ‡ç­¾åç§°ï¼Œç”¨é€—å·åˆ†éš”æˆ–å•ä¸ªè¾“å…¥...">
                                    <button type="button" class="btn btn-outline-primary btn-sm" id="batchEditAddTagBtn">
                                        <i class="bi bi-plus"></i> æ·»åŠ 
                                    </button>
                                </div>
                                <div id="batchEditSelectedTags" class="d-flex flex-wrap gap-1 mb-2">
                                    <!-- é€‰ä¸­çš„æ ‡ç­¾å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                                </div>
                                <div id="batchEditTagsToRemove" style="display: none;">
                                    <label class="form-label small">è¦ç§»é™¤çš„æ ‡ç­¾</label>
                                    <div id="batchEditRemoveTags" class="d-flex flex-wrap gap-1">
                                        <!-- è¦ç§»é™¤çš„æ ‡ç­¾å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- åˆ†ç±»æ“ä½œ -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">åˆ†ç±»æ“ä½œ</label>
                            <div class="mb-2">
                                <select class="form-select" id="batchEditCategoriesOperation">
                                    <option value="">ä¸ä¿®æ”¹åˆ†ç±»</option>
                                    <option value="add">è¿½åŠ åˆ†ç±»</option>
                                    <option value="remove">ç§»é™¤åˆ†ç±»</option>
                                    <option value="replace">æ›¿æ¢æ‰€æœ‰åˆ†ç±»</option>
                                    <option value="clear">æ¸…ç©ºæ‰€æœ‰åˆ†ç±»</option>
                                </select>
                            </div>
                            <div id="batchEditCategoriesInput" style="display: none;">
                                <select class="form-select" id="batchEditCategoryIds" multiple size="5">
                                    <!-- åˆ†ç±»é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                                </select>
                                <div class="form-text small mt-1">æŒ‰ä½ Ctrl/Cmd é”®å¯å¤šé€‰</div>
                            </div>
                        </div>

                        <!-- æ‹æ‘„æ—¶é—´æ“ä½œ -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">æ‹æ‘„æ—¶é—´æ“ä½œ</label>
                            <div class="mb-2">
                                <select class="form-select" id="batchEditTakenAtOperation">
                                    <option value="">ä¸ä¿®æ”¹æ‹æ‘„æ—¶é—´</option>
                                    <option value="set">ç»Ÿä¸€è®¾ç½®ï¼ˆè¦†ç›–æ‰€æœ‰ï¼‰</option>
                                    <option value="fill_empty">åªå¡«å……ç©ºå€¼ï¼ˆä¿ç•™å·²æœ‰ï¼‰</option>
                                    <option value="clear">æ¸…ç©ºæ‰€æœ‰æ‹æ‘„æ—¶é—´</option>
                                </select>
                            </div>
                            <div id="batchEditTakenAtInput" style="display: none;">
                                <input type="datetime-local" class="form-control" id="batchEditTakenAt">
                                <div class="form-text small mt-1">
                                    ç»Ÿä¸€è®¾ç½®æ¨¡å¼ï¼šè¦†ç›–æ‰€æœ‰é€‰ä¸­ç…§ç‰‡çš„æ‹æ‘„æ—¶é—´<br>
                                    å¡«å……æ¨¡å¼ï¼šåªæ›´æ–°æ²¡æœ‰æ‹æ‘„æ—¶é—´çš„ç…§ç‰‡ï¼Œä¿ç•™å·²æœ‰æ—¶é—´
                                </div>
                            </div>
                        </div>

                        <!-- ä½ç½®æ“ä½œ -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">ä½ç½®æ“ä½œ</label>
                            <div class="mb-2">
                                <select class="form-select" id="batchEditLocationOperation">
                                    <option value="">ä¸ä¿®æ”¹ä½ç½®</option>
                                    <option value="set">ç»Ÿä¸€è®¾ç½®ï¼ˆè¦†ç›–æ‰€æœ‰ï¼‰</option>
                                    <option value="fill_empty">åªå¡«å……ç©ºå€¼ï¼ˆä¿ç•™å·²æœ‰ï¼‰</option>
                                    <option value="clear">æ¸…ç©ºæ‰€æœ‰ä½ç½®</option>
                                </select>
                            </div>
                            <div id="batchEditLocationInput" style="display: none;">
                                <input type="text" class="form-control" id="batchEditLocationName" 
                                       placeholder="è¾“å…¥ä½ç½®åç§°...">
                                <div class="form-text small mt-1">
                                    ç»Ÿä¸€è®¾ç½®æ¨¡å¼ï¼šè¦†ç›–æ‰€æœ‰é€‰ä¸­ç…§ç‰‡çš„ä½ç½®<br>
                                    å¡«å……æ¨¡å¼ï¼šåªæ›´æ–°æ²¡æœ‰ä½ç½®çš„ç…§ç‰‡ï¼Œä¿ç•™å·²æœ‰ä½ç½®
                                </div>
                            </div>
                        </div>

                        <!-- æè¿°æ“ä½œ -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">æè¿°æ“ä½œ</label>
                            <div class="mb-2">
                                <select class="form-select" id="batchEditDescriptionOperation">
                                    <option value="">ä¸ä¿®æ”¹æè¿°</option>
                                    <option value="set">ç»Ÿä¸€è®¾ç½®ï¼ˆè¦†ç›–æ‰€æœ‰ï¼‰</option>
                                    <option value="append">è¿½åŠ æè¿°ï¼ˆä¿ç•™åŸæœ‰ï¼‰</option>
                                    <option value="clear">æ¸…ç©ºæ‰€æœ‰æè¿°</option>
                                </select>
                            </div>
                            <div id="batchEditDescriptionInput" style="display: none;">
                                <textarea class="form-control" id="batchEditDescription" rows="3" 
                                          placeholder="è¾“å…¥æè¿°å†…å®¹..."></textarea>
                                <div class="form-text small mt-1">
                                    ç»Ÿä¸€è®¾ç½®æ¨¡å¼ï¼šè¦†ç›–æ‰€æœ‰é€‰ä¸­ç…§ç‰‡çš„æè¿°<br>
                                    è¿½åŠ æ¨¡å¼ï¼šåœ¨æ‰€æœ‰é€‰ä¸­ç…§ç‰‡çš„æè¿°åè¿½åŠ æ–‡æœ¬
                                </div>
                            </div>
                        </div>

                        <!-- æ–‡ä»¶åæ“ä½œ -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">æ–‡ä»¶åæ“ä½œ</label>
                            <div class="mb-2">
                                <select class="form-select" id="batchEditFilenameOperation">
                                    <option value="">ä¸ä¿®æ”¹æ–‡ä»¶å</option>
                                    <option value="add_prefix">æ·»åŠ å‰ç¼€</option>
                                    <option value="add_suffix">æ·»åŠ åç¼€</option>
                                    <option value="set">ç»Ÿä¸€é‡å‘½åï¼ˆå¸¦åºå·ï¼‰</option>
                                </select>
                            </div>
                            <div id="batchEditFilenameInput" style="display: none;">
                                <div id="batchEditFilenamePrefixInput" style="display: none;">
                                    <input type="text" class="form-control" id="batchEditFilenamePrefix" 
                                           placeholder="è¾“å…¥æ–‡ä»¶åå‰ç¼€ï¼Œå¦‚ï¼šæ—…è¡Œ_">
                                    <div class="form-text small mt-1">
                                        å°†åœ¨æ‰€æœ‰é€‰ä¸­ç…§ç‰‡çš„æ–‡ä»¶åå‰æ·»åŠ æ­¤å‰ç¼€
                                    </div>
                                </div>
                                <div id="batchEditFilenameSuffixInput" style="display: none;">
                                    <input type="text" class="form-control" id="batchEditFilenameSuffix" 
                                           placeholder="è¾“å…¥æ–‡ä»¶ååç¼€ï¼Œå¦‚ï¼š_ç¼–è¾‘">
                                    <div class="form-text small mt-1">
                                        å°†åœ¨æ‰€æœ‰é€‰ä¸­ç…§ç‰‡çš„æ–‡ä»¶ååï¼ˆæ‰©å±•åå‰ï¼‰æ·»åŠ æ­¤åç¼€
                                    </div>
                                </div>
                                <div id="batchEditFilenameTemplateInput" style="display: none;">
                                    <input type="text" class="form-control mb-2" id="batchEditFilenameTemplate" 
                                           placeholder="è¾“å…¥æ–‡ä»¶åæ¨¡æ¿ï¼Œå¦‚ï¼šç…§ç‰‡_{åºå·}">
                                    <div class="mb-2">
                                        <label class="form-label small">èµ·å§‹åºå·</label>
                                        <input type="number" class="form-control" id="batchEditFilenameStartIndex" 
                                               min="1" value="1" placeholder="ä»å“ªä¸ªæ•°å­—å¼€å§‹ç¼–å·ï¼ˆé»˜è®¤ï¼š1ï¼‰">
                                    </div>
                                    <div class="form-text small mt-1">
                                        ç»Ÿä¸€é‡å‘½åæ‰€æœ‰ç…§ç‰‡ï¼Œä½¿ç”¨{åºå·}æˆ–{index}ä½œä¸ºå ä½ç¬¦<br>
                                        èµ·å§‹åºå·ï¼šæŒ‡å®šåºå·ä»å“ªä¸ªæ•°å­—å¼€å§‹ç¼–å·<br>
                                        ç¤ºä¾‹ï¼šæ¨¡æ¿"ç…§ç‰‡_{åºå·}"ï¼Œèµ·å§‹åºå·10 â†’ ç…§ç‰‡_10.jpg, ç…§ç‰‡_11.jpg, ...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" id="saveBatchEdit">ä¿å­˜ä¿®æ”¹</button>
                </div>
            </div>
        </div>
    </div>

    <!-- å¯¼å…¥ç…§ç‰‡æ¨¡æ€æ¡† -->
    <div class="modal fade" id="importModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">å¯¼å…¥ç…§ç‰‡</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <!-- å¯¼å…¥æ–¹å¼é€‰æ‹© -->
                    <div class="mb-4">
                        <label class="form-label">é€‰æ‹©å¯¼å…¥æ–¹å¼</label>
                        <div class="btn-group w-100" role="group" id="importMethodGroup">
                            <input type="radio" class="btn-check" name="importMethod" id="fileImport" value="file" checked>
                            <label class="btn btn-outline-primary" for="fileImport">
                                <i class="bi bi-file-earmark-image me-1"></i>
                                é€‰æ‹©æ–‡ä»¶
                            </label>
                            
                            <input type="radio" class="btn-check" name="importMethod" id="folderImport" value="folder">
                            <label class="btn btn-outline-primary" for="folderImport">
                                <i class="bi bi-folder me-1"></i>
                                æ‰«æç›®å½•
                            </label>
                        </div>
                    </div>

                    <!-- æ–‡ä»¶é€‰æ‹©åŒºåŸŸ -->
                    <div id="fileImportSection" class="import-section">
                        <div class="mb-3">
                            <label class="form-label">é€‰æ‹©ç…§ç‰‡æ–‡ä»¶</label>
                            <input type="file" class="form-control" id="photoFiles" multiple accept="image/*,.heic,.heif">
                            <div class="form-text">æ”¯æŒ JPGã€PNGã€TIFFã€WebPã€BMPã€GIFã€HEIC ç­‰å¸¸è§å›¾ç‰‡æ ¼å¼</div>
                        </div>
                    </div>

                    <!-- ç›®å½•æ‰«æåŒºåŸŸ -->
                    <div id="folderImportSection" class="import-section d-none">
                        <div class="mb-3">
                            <label class="form-label">é€‰æ‹©ç…§ç‰‡ç›®å½•</label>
                            <div class="input-group">
                                <input type="file" class="form-control" id="folderFiles" webkitdirectory directory multiple accept="image/*,.heic,.heif" style="display: none;">
                                <input type="text" class="form-control" id="folderPath" placeholder="ç‚¹å‡»æµè§ˆæŒ‰é’®é€‰æ‹©ç…§ç‰‡ç›®å½•" readonly>
                                <button class="btn btn-outline-secondary" type="button" id="browseFolderBtn">
                                    <i class="bi bi-folder2-open me-1"></i>
                                    æµè§ˆ
                                </button>
                            </div>
                            <div class="form-text">
                                <strong>æ”¯æŒæ ¼å¼ï¼š</strong>JPGã€PNGã€TIFFã€WebPã€BMPã€GIFã€HEIC<br>
                                <strong>åŠŸèƒ½ï¼š</strong>é€‰æ‹©æ–‡ä»¶å¤¹åä¼šè‡ªåŠ¨æ‰«ææ‰€æœ‰å­ç›®å½•ä¸­çš„ç…§ç‰‡æ–‡ä»¶
                            </div>
                        </div>
                        
                        <!-- æ–‡ä»¶é¢„è§ˆå’Œç¡®è®¤åŒºåŸŸ -->
                        <div id="folderPreview" class="mt-3" style="display: none;">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="bi bi-folder2-open me-2"></i>
                                        æ–‡ä»¶å¤¹é¢„è§ˆä¸ç¡®è®¤ï¼ˆå«å­æ–‡ä»¶å¤¹ï¼‰
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <!-- æ–‡ä»¶ç»Ÿè®¡ä¿¡æ¯ -->
                                    <div id="fileStats" class="mb-3"></div>
                                    
                                    <!-- é™åˆ¶æ£€æŸ¥ -->
                                    <div id="limitCheck" class="mb-3"></div>
                                    
                                    <!-- ç¡®è®¤æŒ‰é’® -->
                                    <div id="importConfirmation"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- é€‰é¡¹å’Œæç¤ºåŒºåŸŸ -->
                        <div class="mt-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="recursiveScan" checked disabled>
                                <label class="form-check-label" for="recursiveScan">
                                    é€’å½’æ‰«æå­ç›®å½•ï¼ˆè‡ªåŠ¨å¯ç”¨ï¼‰
                                </label>
                            </div>
                            <div class="alert alert-info mt-2">
                                <i class="bi bi-info-circle me-1"></i>
                                <strong>æç¤ºï¼š</strong>é€‰æ‹©æ–‡ä»¶å¤¹åä¼šè‡ªåŠ¨æ‰«ææ‰€æœ‰å­ç›®å½•ã€‚
                            </div>
                        </div>
                    </div>

                    <!-- é”™è¯¯æ˜¾ç¤ºåŒºåŸŸ -->
                    <div id="importError" class="alert alert-danger d-none" role="alert">
                        <i class="bi bi-exclamation-triangle me-2"></i>
                        <span id="importErrorMessage"></span>
                    </div>

                    <!-- è¿›åº¦æ˜¾ç¤º -->
                    <div id="importProgress" class="d-none">
                        <div class="progress mb-3" style="height: 25px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary"
                                 id="importProgressBar"
                                 role="progressbar"
                                 style="width: 0%; min-width: 2%; transition: width 0.3s ease;"
                                 aria-valuenow="0"
                                 aria-valuemin="0"
                                 aria-valuemax="100"></div>
                        </div>
                        <div class="text-center mb-2">
                            <p class="mb-1" id="importStatus">æ­£åœ¨å‡†å¤‡å¯¼å…¥...</p>
                            <small class="text-muted" id="importDetails">è¯·ç¨å€™...</small>
                        </div>
                        <div class="row text-center" id="importStats" style="display: none;">
                            <div class="col-3">
                                <div class="border rounded p-2">
                                    <div class="h5 mb-0 text-primary" id="processedCount">0</div>
                                    <small class="text-muted">å·²å¤„ç†</small>
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="border rounded p-2">
                                    <div class="h5 mb-0 text-success" id="importedCount">0</div>
                                    <small class="text-muted">æˆåŠŸå¯¼å…¥</small>
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="border rounded p-2">
                                    <div class="h5 mb-0 text-warning" id="skippedCount">0</div>
                                    <small class="text-muted">è·³è¿‡</small>
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="border rounded p-2">
                                    <div class="h5 mb-0 text-danger" id="failedCount">0</div>
                                    <small class="text-muted">å¤±è´¥</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- åŸºç¡€åˆ†ææ¨¡æ€æ¡† -->
    <div class="modal fade" id="basicModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">åŸºç¡€åˆ†æ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        åŸºç¡€åˆ†æå°†å¯¹ç…§ç‰‡è¿›è¡Œè´¨é‡è¯„ä¼°ï¼Œç”Ÿæˆæ—¶é—´ã€EXIFç­‰åŸºç¡€æ ‡ç­¾<br>
                        æ­¤åŠŸèƒ½æ— éœ€AIï¼Œå¤„ç†é€Ÿåº¦å¿«ï¼Œå®Œå…¨å…è´¹
                    </div>

                    <!-- ç…§ç‰‡æ•°é‡ç»Ÿè®¡ -->
                    <div class="alert alert-warning" id="basicPhotoCountInfo" style="display: none;">
                        <i class="bi bi-info-circle me-2"></i>
                        <span id="basicPhotoCountText">æ­£åœ¨è·å–ç…§ç‰‡æ•°é‡...</span>
                    </div>

                    <div id="basicProgress" class="d-none mt-3">
                        <div class="progress mb-2">
                            <div class="progress-bar" id="basicProgressBar" style="width: 0%"></div>
                        </div>
                        <p class="text-center" id="basicStatus">æ­£åœ¨å¤„ç†...</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="startBasicBtn">å¼€å§‹åŸºç¡€åˆ†æ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- AIåˆ†ææ¨¡æ€æ¡† -->
    <div class="modal fade" id="aiModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">AIåˆ†æ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        AIåˆ†æå°†å¯¹ç…§ç‰‡è¿›è¡Œæ·±åº¦AIåˆ†æï¼Œç”Ÿæˆå†…å®¹æè¿°ã€æ™ºèƒ½åˆ†ç±»å’ŒAIæ ‡ç­¾<br>
                        è¯·ç¡®ä¿ä½ å·²ç”³è¯·å¹¶é…ç½®äº†Qwen-vlå¤§æ¨¡å‹çš„APIå¯†é’¥ï¼Œ
                        <a href="/help-api-key" target="_blank">å¦‚æœ‰ç–‘é—®ï¼Œè¯·ç‚¹å‡»é“¾æ¥</a>
                    </div>

                    <!-- ç…§ç‰‡æ•°é‡ç»Ÿè®¡ -->
                    <div class="alert alert-warning" id="aiPhotoCountInfo" style="display: none;">
                        <i class="bi bi-info-circle me-2"></i>
                        <span id="aiPhotoCountText">æ­£åœ¨è·å–ç…§ç‰‡æ•°é‡...</span>
                    </div>

                    <!-- AIåˆ†ææ‰¹æ¬¡è®¾ç½® -->
                    <div id="aiBatchSetup" class="mb-3" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0"><i class="bi bi-collection me-2"></i>æ‰¹æ¬¡å¤„ç†è®¾ç½®</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="aiBatchCount" class="form-label">åˆ†å‡ æ‰¹å¤„ç†ï¼š</label>
                                        <input type="number" class="form-control" id="aiBatchCount" value="5" min="1" max="20">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">æ‰¹æ¬¡é¢„è§ˆï¼š</label>
                                        <div id="aiBatchPreview" class="small text-muted">
                                            <!-- åŠ¨æ€æ˜¾ç¤ºæ‰¹æ¬¡åˆ†é… -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="aiProgress" class="d-none mt-3">
                        <div class="progress mb-2">
                            <div class="progress-bar" id="aiProgressBar" style="width: 0%"></div>
                        </div>
                        <p class="text-center" id="aiStatus">æ­£åœ¨å¤„ç†...</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" id="startAIBtn">å¼€å§‹AIåˆ†æ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- å›¾åƒç‰¹å¾æå–æ¨¡æ€æ¡† -->
    <div class="modal fade" id="imageFeatureExtractionModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-image me-2"></i>å›¾åƒç‰¹å¾æå–
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        å›¾åƒç‰¹å¾æå–å°†ä¸ºç…§ç‰‡ç”Ÿæˆæ·±åº¦ç‰¹å¾å‘é‡ï¼Œç”¨äºç²¾ç¡®çš„ç›¸ä¼¼ç…§ç‰‡æœç´¢<br>
                        åŸºäºResNet50æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œæå–2048ç»´ç‰¹å¾å‘é‡<br>
                        æ­¤åŠŸèƒ½è°ƒç”¨æœ¬åœ°æ¨¡å‹ï¼Œå¤„ç†å¿«é€Ÿé«˜æ•ˆ
                    </div>

                    <!-- ç…§ç‰‡æ•°é‡ç»Ÿè®¡ -->
                    <div class="alert alert-warning" id="featurePhotoCountInfo" style="display: none;">
                        <i class="bi bi-info-circle me-2"></i>
                        <span id="featurePhotoCountText">æ­£åœ¨è·å–ç…§ç‰‡æ•°é‡...</span>
                    </div>

                    <!-- æ‰¹æ¬¡ä¿¡æ¯æ˜¾ç¤º -->
                    <div id="featureBatchInfo" class="mb-3" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0"><i class="bi bi-collection me-2"></i>æ‰¹æ¬¡å¤„ç†ä¿¡æ¯</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">æ€»ç…§ç‰‡æ•°ï¼š</label>
                                        <div class="fw-bold" id="featureTotalPhotos">-</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">é¢„è®¡æ‰¹æ¬¡æ•°ï¼š</label>
                                        <div class="fw-bold" id="featureBatchCount">-</div>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-md-6">
                                        <label class="form-label">æ¯æ‰¹ç…§ç‰‡æ•°ï¼š</label>
                                        <div class="text-muted" id="featureBatchSize">-</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">åˆ†æ‰¹é˜ˆå€¼ï¼š</label>
                                        <div class="text-muted" id="featureBatchThreshold">-</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="featureProgress" class="d-none mt-3">
                        <div class="progress mb-2" style="height: 25px;">
                            <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" 
                                 id="featureProgressBar" 
                                 style="width: 0%; min-width: 2%; transition: width 0.3s ease;"></div>
                        </div>
                        <div class="text-center mb-2">
                            <p class="mb-1" id="featureStatus">æ­£åœ¨å‡†å¤‡ç‰¹å¾æå–...</p>
                            <small class="text-muted" id="featureDetails">è¯·ç¨å€™...</small>
                        </div>
                        <div class="row text-center" id="featureStats" style="display: none;">
                            <div class="col-3">
                                <div class="border rounded p-2">
                                    <div class="h5 mb-0 text-primary" id="featureProcessedCount">0</div>
                                    <small class="text-muted">å·²å¤„ç†</small>
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="border rounded p-2">
                                    <div class="h5 mb-0 text-success" id="featureExtractedCount">0</div>
                                    <small class="text-muted">æˆåŠŸæå–</small>
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="border rounded p-2">
                                    <div class="h5 mb-0 text-warning" id="featureSkippedCount">0</div>
                                    <small class="text-muted">è·³è¿‡</small>
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="border rounded p-2">
                                    <div class="h5 mb-0 text-danger" id="featureFailedCount">0</div>
                                    <small class="text-muted">å¤±è´¥</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" id="startFeatureExtractionBtn">å¼€å§‹ç‰¹å¾æå–</button>
                </div>
            </div>
        </div>
    </div>

    <!-- åœ°ç†ç¼–ç æœåŠ¡é€‰æ‹©å¼¹çª— -->
    <div class="modal fade" id="geocodingServiceModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ğŸ“ é€‰æ‹©åœ°å€è§£ææœåŠ¡</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="service-options">
                        <div class="service-option" data-service="amap">
                            <div class="service-header">
                                <span class="service-icon">ğŸŒ</span>
                                <h4>é«˜å¾·åœ°å›¾API</h4>
                                <span class="service-badge online">åœ¨çº¿æœåŠ¡</span>
                            </div>
                            <div class="service-description">
                                <p><strong>ä¼˜åŠ¿ï¼š</strong></p>
                                <ul>
                                    <li>âœ… å›½å†…åœ°å€è¯¦ç»†å‡†ç¡®</li>
                                    <li>âœ… æ”¯æŒä¸­æ–‡åœ°å€</li>
                                    <li>âœ… å®æ—¶æ•°æ®æ›´æ–°</li>
                                </ul>
                                <p><strong>é™åˆ¶ï¼š</strong></p>
                                <ul>
                                    <li>âŒ éœ€è¦ç½‘ç»œè¿æ¥</li>
                                    <li>âŒ éœ€è¦APIå¯†é’¥</li>
                                    <li>âŒ æµ·å¤–åœ°å€æ”¯æŒæœ‰é™</li>
                                </ul>
                            </div>
                            <div class="service-status">
                                <span id="amap-status" class="status-indicator"></span>
                                <span id="amap-status-text">æ£€æŸ¥ä¸­...</span>
                            </div>
                        </div>
                        
                        <div class="service-option" data-service="offline">
                            <div class="service-header">
                                <span class="service-icon">ğŸ </span>
                                <h4>ç¦»çº¿æ•°æ®åº“</h4>
                                <span class="service-badge offline">æœ¬åœ°æœåŠ¡</span>
                            </div>
                            <div class="service-description">
                                <p><strong>ä¼˜åŠ¿ï¼š</strong></p>
                                <ul>
                                    <li>âœ… æ— éœ€ç½‘ç»œè¿æ¥</li>
                                    <li>âœ… æ— éœ€APIå¯†é’¥</li>
                                    <li>âœ… å…¨çƒä¸»è¦åŸå¸‚æ”¯æŒ</li>
                                    <li>âœ… éšç§å®‰å…¨</li>
                                </ul>
                                <p><strong>é™åˆ¶ï¼š</strong></p>
                                <ul>
                                    <li>âŒ åœ°å€ä¿¡æ¯ç›¸å¯¹ç®€å•</li>
                                    <li>âŒ æ•°æ®æ›´æ–°éœ€è¦æ‰‹åŠ¨</li>
                                </ul>
                            </div>
                            <div class="service-status">
                                <span id="offline-status" class="status-indicator ready"></span>
                                <span id="offline-status-text">éšæ—¶å¯ç”¨</span>
                            </div>
                        </div>
                        
                        <div class="service-option" data-service="nominatim">
                            <div class="service-header">
                                <span class="service-icon">ğŸŒ</span>
                                <h4>Nominatim API</h4>
                                <span class="service-badge online">å…¨çƒæœåŠ¡</span>
                            </div>
                            <div class="service-description">
                                <p><strong>ä¼˜åŠ¿ï¼š</strong></p>
                                <ul>
                                    <li>âœ… å…¨çƒåœ°å€è¦†ç›–</li>
                                    <li>âœ… å…è´¹æ— éœ€APIå¯†é’¥</li>
                                    <li>âœ… åŸºäºOpenStreetMapæ•°æ®</li>
                                    <li>âœ… æ”¯æŒå¤šè¯­è¨€</li>
                                </ul>
                                <p><strong>é™åˆ¶ï¼š</strong></p>
                                <ul>
                                    <li>âŒ <span class="text-warning">éœ€è¦ç§‘å­¦ä¸Šç½‘</span></li>
                                    <li>âŒ å›½å†…è®¿é—®å¯èƒ½å—é™</li>
                                    <li>âŒ è¯·æ±‚é¢‘ç‡æœ‰é™åˆ¶</li>
                                </ul>
                            </div>
                            <div class="service-status">
                                <span id="nominatim-status" class="status-indicator"></span>
                                <span id="nominatim-status-text">æ£€æŸ¥ä¸­...</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="help-text">
                        <p><strong>ğŸ’¡ æç¤ºï¼š</strong></p>
                        <p>â€¢ é«˜å¾·åœ°å›¾APIé€‚åˆå›½å†…ç…§ç‰‡ï¼Œåœ°å€ä¿¡æ¯æ›´è¯¦ç»†</p>
                        <p>â€¢ ç¦»çº¿æ•°æ®åº“é€‚åˆæµ·å¤–ç…§ç‰‡æˆ–ç½‘ç»œä¸ç¨³å®šæ—¶ä½¿ç”¨</p>
                        <p>â€¢ Nominatim APIé€‚åˆå…¨çƒç…§ç‰‡ï¼Œä½†éœ€è¦ç§‘å­¦ä¸Šç½‘</p>
                        <p>â€¢ æ‚¨å¯ä»¥åœ¨è®¾ç½®ä¸­é…ç½®é»˜è®¤æœåŠ¡</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" id="confirmGeocoding" disabled>ç¡®è®¤é€‰æ‹©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ç›¸ä¼¼ç…§ç‰‡æœç´¢æœåŠ¡é€‰æ‹©å¼¹çª— -->
    <div class="modal fade" id="similarPhotoSearchModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ğŸ” é€‰æ‹©ç›¸ä¼¼ç…§ç‰‡æœç´¢æ–¹å¼</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="service-options">
                        <!-- ç‰¹å¾å‘é‡ç›¸ä¼¼æœç´¢ -->
                        <div class="service-option" data-service="features">
                            <div class="service-header">
                                <span class="service-icon">ğŸ¯</span>
                                <h4>ç‰¹å¾å‘é‡æœç´¢</h4>
                                <span class="service-badge online">ç²¾ç¡®æœç´¢</span>
                            </div>
                            <div class="service-description">
                                <p><strong>ä¼˜åŠ¿ï¼š</strong></p>
                                <ul>
                                    <li>âœ… åŸºäºResNet50æ·±åº¦ç‰¹å¾ï¼Œç²¾åº¦é«˜</li>
                                    <li>âœ… æœç´¢é€Ÿåº¦å¿«ï¼Œå“åº”è¿…é€Ÿ</li>
                                    <li>âœ… èƒ½è¯†åˆ«è§†è§‰ç›¸ä¼¼ä½†é¢œè‰²/äº®åº¦ä¸åŒçš„ç…§ç‰‡</li>
                                    <li>âœ… é€‚åˆç²¾ç¡®æŸ¥æ‰¾è§†è§‰ç›¸ä¼¼ç…§ç‰‡</li>
                                </ul>
                                <p><strong>ç‰¹ç‚¹ï¼š</strong></p>
                                <ul>
                                    <li>ä½¿ç”¨2048ç»´æ·±åº¦ç‰¹å¾å‘é‡</li>
                                    <li>åŸºäºä½™å¼¦ç›¸ä¼¼åº¦åŒ¹é…</li>
                                    <li>éœ€è¦å…ˆè¿è¡Œ"ç‰¹å¾æå–"æ‰¹å¤„ç†</li>
                                </ul>
                            </div>
                            <div class="service-status">
                                <span class="status-indicator ready"></span>
                                <span>éœ€è¦å…ˆæå–ç‰¹å¾</span>
                            </div>
                        </div>
                        
                        <!-- æ™ºèƒ½åˆ†æç›¸ä¼¼æœç´¢ -->
                        <div class="service-option" data-service="enhanced">
                            <div class="service-header">
                                <span class="service-icon">ğŸ¤–</span>
                                <h4>æ™ºèƒ½åˆ†æç›¸ä¼¼æœç´¢</h4>
                                <span class="service-badge online">æ™ºèƒ½æœç´¢</span>
                            </div>
                            <div class="service-description">
                                <p><strong>ä¼˜åŠ¿ï¼š</strong></p>
                                <ul>
                                    <li>âœ… ç»¼åˆå¤šç§ç‰¹å¾ï¼ˆæ—¶é—´ã€ä½ç½®ã€ç›¸æœºç­‰ï¼‰</li>
                                    <li>âœ… æ™ºèƒ½é¢„ç­›é€‰ï¼Œå‡å°‘å€™é€‰ç…§ç‰‡</li>
                                    <li>âœ… æ”¯æŒAIåˆ†æå¢å¼ºï¼ˆå¦‚æœæœ‰ï¼‰</li>
                                    <li>âœ… ç»“æœæ›´ç²¾å‡†ï¼Œè€ƒè™‘æ›´å¤šç»´åº¦</li>
                                </ul>
                                <p><strong>ç‰¹ç‚¹ï¼š</strong></p>
                                <ul>
                                    <li>åŸºäºæ—¶é—´ã€ä½ç½®ç­‰é¢„ç­›é€‰</li>
                                    <li>ç»¼åˆå¤šç§ç›¸ä¼¼åº¦ç®—æ³•</li>
                                    <li>é€‚åˆéœ€è¦é«˜ç²¾åº¦çš„åœºæ™¯</li>
                                </ul>
                            </div>
                            <div class="service-status">
                                <span class="status-indicator ready"></span>
                                <span>éšæ—¶å¯ç”¨</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="help-text">
                        <p><strong>ğŸ’¡ æç¤ºï¼š</strong></p>
                        <p>â€¢ ç‰¹å¾å‘é‡æœç´¢ï¼šåŸºäºæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œç²¾åº¦é«˜ï¼Œé€‚åˆç²¾ç¡®æŸ¥æ‰¾è§†è§‰ç›¸ä¼¼çš„ç…§ç‰‡ï¼ˆéœ€è¦å…ˆè¿è¡Œç‰¹å¾æå–ï¼‰</p>
                        <p>â€¢ æ™ºèƒ½åˆ†æç›¸ä¼¼æœç´¢ï¼šç»¼åˆå¤šç§ç‰¹å¾ï¼ˆæ—¶é—´ã€ä½ç½®ã€ç›¸æœºç­‰ï¼‰ï¼Œç»“æœæ›´ç²¾å‡†ä½†å¯èƒ½è¾ƒæ…¢</p>
                        <p>â€¢ æ‚¨å¯ä»¥åœ¨è®¾ç½®ä¸­é…ç½®é»˜è®¤æœç´¢æ–¹å¼</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" id="confirmSimilarSearch" disabled>ç¡®è®¤é€‰æ‹©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- æœç´¢å¸®åŠ©é¢æ¿ -->
    <div class="search-help-panel position-fixed" id="searchHelpPanel" style="display: none; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1050;">
        <div class="card" style="max-width: 800px; max-height: 600px;">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0">
                    <i class="bi bi-question-circle me-2"></i>
                    æœç´¢å¸®åŠ©
                </h6>
                <button type="button" class="btn-close" onclick="hideSearchHelp()"></button>
            </div>
            <div class="card-body" style="overflow-y: auto;">
                <div class="row">
                    <div class="col-md-6">
                        <h6>åŸºç¡€æœç´¢</h6>
                        <ul class="list-unstyled small">
                            <li><code>èŠ±æœµ</code> - æœç´¢åŒ…å«"èŠ±æœµ"çš„ç…§ç‰‡</li>
                            <li><code>Apple iPhone</code> - æœç´¢åŒ…å«"Apple"å’Œ"iPhone"çš„ç…§ç‰‡</li>
                            <li><code>"Apple iPhone"</code> - ç²¾ç¡®åŒ¹é…"Apple iPhone"</li>
                        </ul>
                        
                        <h6>é«˜çº§æœç´¢</h6>
                        <ul class="list-unstyled small">
                            <li><code>èŠ±æœµ AND ç›†æ ½</code> - åŒæ—¶åŒ…å«"èŠ±æœµ"å’Œ"ç›†æ ½"</li>
                            <li><code>èŠ±æœµ OR æ¤ç‰©</code> - åŒ…å«"èŠ±æœµ"æˆ–"æ¤ç‰©"</li>
                            <li><code>èŠ±æœµ NOT ç›†æ ½</code> - åŒ…å«"èŠ±æœµ"ä½†ä¸åŒ…å«"ç›†æ ½"</li>
                            <li><code>èŠ±æœµ%</code> - ä»¥"èŠ±æœµ"å¼€å¤´çš„è¯ï¼ˆæ¨èï¼‰</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6>æœç´¢èŒƒå›´</h6>
                        <ul class="list-unstyled small">
                            <li><strong>å…¨éƒ¨å†…å®¹ï¼š</strong>æ–‡ä»¶åã€æ ‡ç­¾ã€åˆ†ç±»ã€æè¿°ã€AIåˆ†æ</li>
                            <li><strong>æ–‡ä»¶åï¼š</strong>ä»…æœç´¢ç…§ç‰‡æ–‡ä»¶å</li>
                            <li><strong>ç”¨æˆ·æè¿°ï¼š</strong>ä»…æœç´¢ç”¨æˆ·æ·»åŠ çš„æè¿°</li>
                            <li><strong>AIåˆ†æç»“æœï¼š</strong>ä»…æœç´¢AIè‡ªåŠ¨åˆ†æçš„å†…å®¹</li>
                        </ul>
                        
                        <h6>çƒ­é—¨æœç´¢è¯</h6>
                        <div class="d-flex flex-wrap gap-1">
                            <span class="badge bg-secondary" onclick="searchSuggestion('èŠ±æœµ%')">èŠ±æœµ</span>
                            <span class="badge bg-secondary" onclick="searchSuggestion('ç›†æ ½%')">ç›†æ ½</span>
                            <span class="badge bg-secondary" onclick="searchSuggestion('æ¬¢ä¹%')">æ¬¢ä¹</span>
                            <span class="badge bg-secondary" onclick="searchSuggestion('å®é™%')">å®é™</span>
                            <span class="badge bg-secondary" onclick="searchSuggestion('å®¤å†…%')">å®¤å†…</span>
                            <span class="badge bg-secondary" onclick="searchSuggestion('æˆ·å¤–%')">æˆ·å¤–</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ç…§ç‰‡å±•ç¤ºåŒºå¸®åŠ©é¢æ¿ -->
    <div class="photo-display-help-panel position-fixed" id="photoDisplayHelpPanel" style="display: none; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1050;">
        <div class="card" style="max-width: 900px; max-height: 700px;">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0">
                    <i class="bi bi-question-circle me-2"></i>
                    ç…§ç‰‡å±•ç¤ºåŒºå¸®åŠ©
                </h6>
                <button type="button" class="btn-close" onclick="hidePhotoDisplayHelp()"></button>
            </div>
            <div class="card-body" style="overflow-y: auto;">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="bi bi-grid-3x3-gap me-2"></i>è§†å›¾æ¨¡å¼</h6>
                        <ul class="list-unstyled small">
                            <li class="mb-2">
                                <i class="bi bi-grid-3x3-gap me-2 text-primary"></i>
                                <strong>ç½‘æ ¼è§†å›¾ï¼š</strong>ä»¥ç´§å‡‘çš„ç½‘æ ¼å½¢å¼å±•ç¤ºç…§ç‰‡ç¼©ç•¥å›¾ï¼Œé€‚åˆå¿«é€Ÿæµè§ˆå¤§é‡ç…§ç‰‡
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-list me-2 text-primary"></i>
                                <strong>åˆ—è¡¨è§†å›¾ï¼š</strong>ä»¥åˆ—è¡¨å½¢å¼å±•ç¤ºç…§ç‰‡ï¼Œå¯èƒ½åŒ…å«æ›´å¤šè¯¦ç»†ä¿¡æ¯
                            </li>
                        </ul>
                        
                        <h6><i class="bi bi-mouse me-2"></i>ç…§ç‰‡é€‰æ‹©</h6>
                        <ul class="list-unstyled small">
                            <li class="mb-2">
                                <i class="bi bi-square me-2 text-primary"></i>
                                <strong>é€‰æ‹©æ¡†ï¼š</strong>æ¯å¼ ç…§ç‰‡å·¦ä¸Šè§’éƒ½æœ‰ä¸€ä¸ªé€‰æ‹©æ¡†ï¼Œç‚¹å‡»å³å¯é€‰æ‹©/å–æ¶ˆé€‰æ‹©ç…§ç‰‡
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-eye me-2 text-info"></i>
                                <strong>æŸ¥çœ‹è¯¦æƒ…ï¼š</strong>ç‚¹å‡»ç…§ç‰‡å›¾åƒæŸ¥çœ‹å¤§å›¾å’Œè¯¦ç»†ä¿¡æ¯
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-check-all me-2 text-success"></i>
                                <strong>å…¨é€‰ï¼š</strong>ç‚¹å‡»"å…¨é€‰"æŒ‰é’®é€‰æ‹©å½“å‰é¡µæ‰€æœ‰ç…§ç‰‡
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-x-circle me-2 text-warning"></i>
                                <strong>å–æ¶ˆé€‰æ‹©ï¼š</strong>ç‚¹å‡»"å–æ¶ˆé€‰æ‹©"æŒ‰é’®æ¸…ç©ºé€‰æ‹©ï¼Œæˆ–å†æ¬¡ç‚¹å‡»é€‰æ‹©æ¡†å–æ¶ˆé€‰æ‹©
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-lightbulb me-2 text-secondary"></i>
                                <strong>æç¤ºï¼š</strong>é€‰æ‹©æ¡†æ˜¯æ°¸ä¹…å¯è§çš„ï¼Œæ— éœ€ç‰¹æ®Šæ“ä½œå³å¯ç›´æ¥é€‰æ‹©ç…§ç‰‡
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="bi bi-gear me-2"></i>æ“ä½œæŒ‰é’®</h6>
                        <ul class="list-unstyled small">
                            <li class="mb-2">
                                <i class="bi bi-check-all me-2 text-primary"></i>
                                <strong>å…¨é€‰ï¼š</strong>é€‰ä¸­å½“å‰é¡µé¢æ‰€æœ‰ç…§ç‰‡
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-x-circle me-2 text-secondary"></i>
                                <strong>å–æ¶ˆé€‰æ‹©ï¼š</strong>å–æ¶ˆæ‰€æœ‰å·²é€‰ä¸­çš„ç…§ç‰‡
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-trash me-2 text-danger"></i>
                                <strong>åˆ é™¤é€‰ä¸­ï¼š</strong>æ°¸ä¹…åˆ é™¤æ‰€æœ‰é€‰ä¸­çš„ç…§ç‰‡ï¼ˆè°¨æ…æ“ä½œï¼‰
                            </li>
                        </ul>
                        
                        <h6><i class="bi bi-hand-index me-2"></i>ç…§ç‰‡äº¤äº’</h6>
                        <ul class="list-unstyled small">
                            <li class="mb-2">
                                <i class="bi bi-mouse me-2 text-info"></i>
                                <strong>æ‚¬åœæ•ˆæœï¼š</strong>é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºå››ä¸ªæ“ä½œæŒ‰é’®
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-eye me-2 text-light"></i>
                                <strong>æŸ¥çœ‹è¯¦æƒ…ï¼š</strong>ç‚¹å‡»æŸ¥çœ‹ç…§ç‰‡å¤§å›¾å’Œè¯¦ç»†ä¿¡æ¯
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-pencil me-2 text-warning"></i>
                                <strong>ç¼–è¾‘ï¼š</strong>ç‚¹å‡»ç¼–è¾‘ç…§ç‰‡æ ‡ç­¾å’Œæè¿°ä¿¡æ¯
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-trash me-2 text-danger"></i>
                                <strong>åˆ é™¤ï¼š</strong>ç‚¹å‡»åˆ é™¤å•å¼ ç…§ç‰‡
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-search me-2 text-info"></i>
                                <strong>ç›¸ä¼¼ç…§ç‰‡ï¼š</strong>ç‚¹å‡»æœç´¢ç›¸ä¼¼çš„ç…§ç‰‡
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="row mt-3">
                    <div class="col-12">
                        <h6><i class="bi bi-info-circle me-2"></i>ç…§ç‰‡ä¿¡æ¯</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <ul class="list-unstyled small">
                                    <li class="mb-2">
                                        <i class="bi bi-square me-2 text-primary"></i>
                                        <strong>é€‰æ‹©æ¡†ï¼š</strong>å·¦ä¸Šè§’çš„é€‰æ‹©æ¡†ï¼Œç‚¹å‡»å¯é€‰æ‹©/å–æ¶ˆé€‰æ‹©ç…§ç‰‡
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-image me-2 text-primary"></i>
                                        <strong>ç¼©ç•¥å›¾ï¼š</strong>ç…§ç‰‡çš„é¢„è§ˆå›¾ï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-star me-2 text-warning"></i>
                                        <strong>è´¨é‡ç­‰çº§ï¼š</strong>ç…§ç‰‡çš„è´¨é‡è¯„ä¼°ï¼ˆä¼˜ç§€ã€è‰¯å¥½ã€ä¸€èˆ¬ã€è¾ƒå·®ã€å¾ˆå·®ï¼‰
                                    </li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="list-unstyled small">
                                    <li class="mb-2">
                                        <i class="bi bi-tags me-2 text-success"></i>
                                        <strong>æ ‡ç­¾ï¼š</strong>ç…§ç‰‡çš„æ ‡ç­¾ä¿¡æ¯
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-clock me-2 text-info"></i>
                                        <strong>æ‹æ‘„æ—¶é—´ï¼š</strong>ç…§ç‰‡çš„æ‹æ‘„æ—¥æœŸå’Œæ—¶é—´
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-3">
                    <div class="col-12">
                        <h6><i class="bi bi-arrow-left-right me-2"></i>åˆ†é¡µå¯¼èˆª</h6>
                        <ul class="list-unstyled small">
                            <li class="mb-2">
                                <i class="bi bi-info-square me-2 text-secondary"></i>
                                <strong>åˆ†é¡µä¿¡æ¯ï¼š</strong>æ˜¾ç¤ºå½“å‰é¡µæ•°å’Œæ€»é¡µæ•°
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-list-ol me-2 text-secondary"></i>
                                <strong>æ¯é¡µæ˜¾ç¤ºæ•°é‡ï¼š</strong>å¯ä»¥è°ƒæ•´æ¯é¡µæ˜¾ç¤ºçš„ç…§ç‰‡æ•°é‡
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-chevron-left me-2 text-secondary"></i>
                                <i class="bi bi-chevron-right me-2 text-secondary"></i>
                                <strong>ç¿»é¡µæŒ‰é’®ï¼š</strong>å¯ä»¥å¿«é€Ÿè·³è½¬åˆ°å…¶ä»–é¡µé¢
                            </li>
                        </ul>
                    </div>
                </div>


            </div>
        </div>
    </div>

    <!-- Chart.js -->
    <script src="lib/chart.js/chart.umd.js"></script>

    <!-- Bootstrap JS - ä¼˜å…ˆä½¿ç”¨æœ¬åœ°ç‰ˆæœ¬ -->
    <script src="lib/bootstrap/js/bootstrap.bundle.min.js"></script>
    
    <!-- CDNå¤‡ç”¨åŠ è½½ -->
    <script>
        // å¦‚æœæœ¬åœ°Bootstrap JSåŠ è½½å¤±è´¥ï¼Œå°è¯•CDN
        setTimeout(function() {
            if (typeof bootstrap === 'undefined') {
                console.warn('æœ¬åœ°Bootstrap JSåŠ è½½å¤±è´¥ï¼Œå°è¯•CDN');
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js';
                script.onload = function() {
                    console.log('CDN Bootstrap JSåŠ è½½æˆåŠŸ');
                    // é‡æ–°åˆå§‹åŒ–UIç»„ä»¶
                    if (typeof initializeUI === 'function') {
                        initializeUI();
                    }
                };
                document.head.appendChild(script);
            }
        }, 2000);
    </script>
    
    
    <!-- æµè§ˆå™¨å…¼å®¹æ€§ä¿®å¤ -->
    <script>
        // æµè§ˆå™¨å…¼å®¹æ€§æ£€æµ‹å’Œä¿®å¤
        function detectBrowser() {
            const userAgent = navigator.userAgent;
            const isEdge = userAgent.indexOf('Edg') > -1;
            const isChrome = userAgent.indexOf('Chrome') > -1 && !isEdge;
            const isFirefox = userAgent.indexOf('Firefox') > -1;
            const isSafari = userAgent.indexOf('Safari') > -1 && !isChrome && !isEdge;
            
            return { isEdge, isChrome, isFirefox, isSafari };
        }
        
        const browser = detectBrowser();
        
        // åªå¯¹Edgeæµè§ˆå™¨åº”ç”¨ç‰¹å®šçš„ä¿®å¤
        if (browser.isEdge) {
            // æ·»åŠ Edgeæµè§ˆå™¨ç‰¹å®šçš„CSSç±»
            document.documentElement.classList.add('edge-browser');
            
            // ä¿®å¤Edgeæµè§ˆå™¨çš„Flexboxé—®é¢˜
            if (!CSS.supports('display', 'flex')) {
                document.documentElement.classList.add('no-flexbox');
            }
            
            // ä¿®å¤Edgeæµè§ˆå™¨çš„Gridé—®é¢˜
            if (!CSS.supports('display', 'grid')) {
                document.documentElement.classList.add('no-grid');
            }
            
            // ä¿®å¤Edgeæµè§ˆå™¨çš„CSSå˜é‡é—®é¢˜
            if (!CSS.supports('color', 'var(--test)')) {
                document.documentElement.classList.add('no-css-vars');
            }
        }
        
        // ç¡®ä¿Bootstrap 5åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­æ­£å¸¸å·¥ä½œ
        document.addEventListener('DOMContentLoaded', function() {
            // åªåœ¨Edgeæµè§ˆå™¨ä¸­åº”ç”¨ç‰¹å®šçš„ä¿®å¤
            if (browser.isEdge) {
                // ä¿®å¤Edgeæµè§ˆå™¨çš„æ¨¡æ€æ¡†é—®é¢˜
                var modals = document.querySelectorAll('.modal');
                modals.forEach(function(modal) {
                    modal.addEventListener('shown.bs.modal', function() {
                        // ç¡®ä¿æ¨¡æ€æ¡†åœ¨Edgeæµè§ˆå™¨ä¸­æ­£ç¡®æ˜¾ç¤º
                        this.style.display = 'block';
                    });
                });
                
                // ä¿®å¤Edgeæµè§ˆå™¨çš„è¡¨å•æ§ä»¶é—®é¢˜
                var formControls = document.querySelectorAll('.form-control, .form-select');
                formControls.forEach(function(control) {
                    control.addEventListener('focus', function() {
                        this.style.borderColor = '#0d6efd';
                        this.style.boxShadow = '0 0 0 0.2rem rgba(13, 110, 253, 0.25)';
                    });
                    control.addEventListener('blur', function() {
                        this.style.borderColor = '#ced4da';
                        this.style.boxShadow = 'none';
                    });
                });
            }
            
            // é€šç”¨ä¿®å¤ï¼šç¡®ä¿æ‰€æœ‰æµè§ˆå™¨çš„ä¸‹æ‹‰èœå•æ­£å¸¸å·¥ä½œ
            var dropdowns = document.querySelectorAll('.dropdown-toggle');
            dropdowns.forEach(function(dropdown) {
                // ç§»é™¤å¯èƒ½å†²çªçš„äº‹ä»¶ç›‘å¬å™¨
                dropdown.removeEventListener('click', handleDropdownClick);
                
                // æ·»åŠ æ–°çš„äº‹ä»¶ç›‘å¬å™¨
                dropdown.addEventListener('click', handleDropdownClick);
            });
            
            function handleDropdownClick(e) {
                // è®©Bootstrap 5å¤„ç†ä¸‹æ‹‰èœå•ï¼Œä¸è¦é˜»æ­¢é»˜è®¤è¡Œä¸º
                // åªåœ¨å¿…è¦æ—¶è¿›è¡Œå¹²é¢„
                var menu = this.nextElementSibling;
                if (menu && menu.classList.contains('dropdown-menu')) {
                    // ç¡®ä¿èœå•æœ‰æ­£ç¡®çš„z-index
                    if (!menu.style.zIndex) {
                        menu.style.zIndex = '9999';
                    }
                }
            }
            
            // é€šç”¨ä¿®å¤ï¼šç¡®ä¿æ‰€æœ‰æµè§ˆå™¨çš„åŸºæœ¬åŠŸèƒ½æ­£å¸¸
            console.log('æµè§ˆå™¨æ£€æµ‹ç»“æœ:', browser);
        });
    </script>

    <!-- è‡ªå®šä¹‰JavaScript -->
            <script src="js/hybrid-interaction.js?v=20250120_01"></script>
            <script src="js/app-utils.js?v=20250120_02"></script>
            <script src="js/app-data.js?v=20250120_01"></script>
            <script src="js/stats-panel.js?v=20250120_01"></script>
            <script src="js/app-ui.js?v=20250120_01"></script>
            <script src="js/app-events.js?v=20250120_01"></script>
            <script src="js/app-import.js?v=20250120_31"></script>
            <script src="js/app-photos.js?v=20250120_02"></script>
            <script src="js/image-feature-extraction.js?v=20250120_01"></script>
            <script src="js/portrait-filter.js?v=20250120_01"></script>
            <script src="js/search-multiselect.js?v=20250120_01"></script>
            <script src="js/app.js?v=20250120_01"></script>
            <script src="js/photo-manager.js?v=20250120_01"></script>
            <script src="js/slideshow-player.js?v=20250120_01"></script>
            <script src="js/slideshow-ui.js?v=20250120_01"></script>
    <script src="js/ui-components.js"></script>
</body>
</html>
