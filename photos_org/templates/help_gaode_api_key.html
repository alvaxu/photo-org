<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>高德地图API Key获取指南 - 家庭版智能照片系统</title>

    <!-- Bootstrap CSS - 优先使用本地版本 -->
    <link href="/static/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/lib/bootstrap-icons/css/bootstrap-icons.min.css" rel="stylesheet">

    <!-- Bootstrap Icons 字体修复 -->
    <style>
        @font-face {
            font-display: block;
            font-family: "bootstrap-icons";
            src: url("/static/lib/bootstrap-icons/fonts/bootstrap-icons.woff2?2ab2cbbe07fcebb53bdaa7313bb290f2") format("woff2"),
                 url("/static/lib/bootstrap-icons/fonts/bootstrap-icons.woff?2ab2cbbe07fcebb53bdaa7313bb290f2") format("woff");
        }
    </style>

    <!-- CDN备用加载 -->
    <script>
        // 如果本地资源加载失败，尝试CDN
        setTimeout(function() {
            const links = document.querySelectorAll('link[href*="/static/lib/"]');
            links.forEach(link => {
                if (!link.sheet) {
                    console.warn('本地资源加载失败，尝试CDN:', link.href);
                    if (link.href.includes('bootstrap.min.css')) {
                        link.href = 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css';
                    } else if (link.href.includes('bootstrap-icons.min.css')) {
                        link.href = 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css';
                    }
                }
            });
        }, 2000);
    </script>

    <!-- 自定义样式 -->
    <link href="/static/css/style.css?v=20250119_80" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/images/favicon.ico">

    <style>
        .help-content {
            max-width: 1000px;
            margin: 0 auto;
        }
        .help-image {
            max-width: 100%;
            height: auto;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            margin: 1rem 0;
        }
        .step-card {
            border-left: 4px solid #0d6efd;
            background-color: #f8f9fa;
        }
        .warning-box {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 0.375rem;
            padding: 1rem;
            margin: 1rem 0;
        }
        .info-box {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 0.375rem;
            padding: 1rem;
            margin: 1rem 0;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 0.375rem;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- 主内容区域 -->
    <div class="container-fluid mt-4">
        <div class="help-content">
            <h1 class="mb-4">
                <i class="bi bi-geo-alt me-2"></i>
                高德地图API Key获取指南
            </h1>

            <div class="alert alert-info">
                <i class="bi bi-info-circle me-2"></i>
                本系统支持三种方式将照片GPS坐标转换为具体地址。如果你选用高德API进行地址转换，那么您需要获取高德地图API Key并在设置页面中配置。
            </div>

            <div class="alert alert-success">
                <i class="bi bi-gear me-2"></i>
                <strong>配置API Key：</strong>获取API Key后，请前往
                <a href="/settings" class="alert-link">系统设置页面</a>
                的"地址解析设置"部分进行配置和测试。
            </div>

            <!-- 一、开通高德地图API -->
            <section class="mb-5">
                <h2 class="h3 mb-3">一、开通高德地图API服务</h2>

                <p>访问<a href="https://lbs.amap.com/" target="_blank" class="text-decoration-none">高德开放平台</a>，注册账号并开通地图服务。</p>

                <div class="info-box">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>说明：</strong>高德地图API提供免费额度，超出部分按量计费，并有限流措施。具体参见官方网站。
                </div>
            </section>

            <!-- 二、获取API Key -->
            <section class="mb-5">
                <h2 class="h3 mb-3">二、获取API Key</h2>

                <div class="step-card p-3 mb-3">
                    <h4 class="h5">步骤1：创建应用</h4>
                    <p>登录高德开放平台 → 控制台 → 应用管理 → 创建新应用</p>
                    <div class="text-center">
                        <img src="/static/images/help/gaode-step1.png" alt="创建应用" class="help-image"
                             onerror="this.style.display='none'">
                        <p class="text-muted small">图1：创建新应用</p>
                    </div>
                </div>

                <div class="step-card p-3 mb-3">
                    <h4 class="h5">步骤2：添加Key</h4>
                    <p>选择应用 → 添加Key → 选择"Web服务API" → 提交</p>
                    <div class="text-center">
                        <img src="/static/images/help/gaode-step2.png" alt="添加API Key" class="help-image"
                             onerror="this.style.display='none'">
                        <p class="text-muted small">图2：添加API Key</p>
                    </div>
                </div>

                <div class="step-card p-3 mb-3">
                    <h4 class="h5">步骤3：获取Key</h4>
                    <p>复制生成的32位Key字符串</p>
                    <div class="text-center">
                        <img src="/static/images/help/gaode-step3.png" alt="获取API Key" class="help-image"
                             onerror="this.style.display='none'">
                        <p class="text-muted small">图3：复制API Key</p>
                    </div>
                </div>

                <div class="warning-box">
                    <i class="bi bi-exclamation-triangle me-2"></i>
                    <strong>重要提醒：</strong>
                    <ul class="mb-0">
                        <li>API Key是32位字符串，请完整复制</li>
                        <li>不要泄露您的API Key给他人</li>
                        <li>如有泄露风险，请及时删除并重新创建</li>
                    </ul>
                </div>
            </section>

            <!-- 三、配置API Key -->
            <section class="mb-5">
                <h2 class="h3 mb-3">三、配置API Key</h2>

                <div class="info-box">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>配置说明：</strong>获取API Key后，请按照以下步骤进行配置：
                    <ol class="mt-2 mb-0">
                        <li>访问<a href="/settings" class="text-decoration-none">系统设置页面</a></li>
                        <li>找到"地址解析设置"部分</li>
                        <li>在"高德地图API密钥"输入框中输入您的API Key</li>
                        <li>点击"测试"按钮验证API Key是否有效</li>
                        <li>点击"保存配置"按钮保存设置</li>
                    </ol>
                </div>

                <div class="warning-box">
                    <i class="bi bi-exclamation-triangle me-2"></i>
                    <strong>重要提醒：</strong>
                    <ul class="mb-0">
                        <li>API Key是32位字符串，请完整复制</li>
                        <li>不要泄露您的API Key给他人</li>
                        <li>如有泄露风险，请及时删除并重新创建</li>
                        <li>配置完成后建议先测试再保存</li>
                    </ul>
                </div>
            </section>

            <!-- 四、使用说明 -->
            <section class="mb-5">
                <h2 class="h3 mb-3">四、使用说明</h2>

                <div class="info-box">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>GPS转地址功能说明：</strong>
                    <ul class="mt-2 mb-0">
                        <li><strong>适用范围：</strong>仅对拍摄时开启GPS定位的照片有效</li>
                        <li><strong>转换精度：</strong>根据GPS坐标精确定位到具体地址</li>
                        <li><strong>缓存机制：</strong>相同坐标只调用一次API，提高效率</li>
                        <li><strong>批量转换：</strong>导航栏按钮可批量转换所有未处理的照片</li>
                        <li><strong>单张重解析：</strong>照片卡片可单独重解析地址</li>
                    </ul>
                </div>

                <div class="warning-box">
                    <i class="bi bi-exclamation-triangle me-2"></i>
                    <strong>注意事项：</strong>
                    <ul class="mb-0">
                        <li>请确保照片拍摄时开启了GPS定位功能</li>
                        <li>室内拍摄或GPS信号弱的照片可能无法获取准确地址</li>
                        <li>API调用有频率限制，请勿短时间内大量调用</li>
                        <li>地址信息仅供参考，实际位置可能有偏差</li>
                    </ul>
                </div>
            </section>

            <!-- 五、如何开启GPS定位功能 -->
            <section class="mb-5">
                <h2 class="h3 mb-3">五、如何开启GPS定位功能</h2>

                <p class="lead">只有在拍摄照片时开启GPS定位功能，照片才会包含位置信息。以下以iPhone为例说明开启方法：</p>

                <div class="step-card p-3 mb-3">
                    <h4 class="h5">步骤1：开启"定位服务"</h4>
                    <p>打开 iPhone 设置 → 隐私与安全性 → 开启"定位服务"。</p>
                    <div class="text-center">
                        <img src="/static/images/help/1c61a91b754a2b276052f8bdbf34b87d.png"
                             alt="开启定位服务" class="help-image"
                             onerror="this.style.display='none'">
                        <p class="text-muted small">图4：开启定位服务</p>
                    </div>
                </div>

                <div class="step-card p-3 mb-3">
                    <h4 class="h5">步骤2：为"相机"开启定位权限</h4>
                    <p>在 iPhone 设置 → 隐私与安全性 → 定位服务下方的应用列表中，找到"相机"，然后选择"使用 App"期间，如果想要保留照片拍摄的精确位置，请打开"精确位置"开关。</p>
                    <div class="text-center">
                        <img src="/static/images/help/1673505034616098583.png"
                             alt="为相机开启定位权限" class="help-image"
                             onerror="this.style.display='none'">
                        <p class="text-muted small">图5：为相机开启定位权限</p>
                    </div>
                </div>

                <div class="info-box">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>其他设备说明：</strong>
                    <ul class="mt-2 mb-0">
                        <li><strong>Android设备：</strong>设置 → 位置 → 开启位置服务，并为相机应用授予位置权限</li>
                        <li><strong>其他iOS设备：</strong>设置方法类似，建议开启"精确位置"以获得更好的定位精度</li>
                        <li><strong>第三方相机App：</strong>请在系统设置中为相应的App开启定位权限</li>
                    </ul>
                </div>

                <div class="warning-box">
                    <i class="bi bi-exclamation-triangle me-2"></i>
                    <strong>重要提醒：</strong>
                    <ul class="mb-0">
                        <li>GPS定位功能需要在室外或有良好信号的环境下才能正常工作</li>
                        <li>室内拍摄的照片通常无法获得准确的GPS信息</li>
                        <li>如果照片没有GPS信息，即使配置了API Key也无法转换为地址</li>
                        <li>建议在户外拍摄重要照片时开启GPS定位</li>
                    </ul>
                </div>
            </section>

        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- 页面专用脚本已移除，配置功能已合并到设置页面 -->
</body>
</html>
