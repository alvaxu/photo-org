å¥½çš„ï¼Œæˆ‘æ¥å®Œå–„è¿™ä¸ªæ–¹æ¡ˆï¼Œç¡®ä¿æ¡Œé¢ç«¯çš„Ctrl+ç‚¹å‡»åŠŸèƒ½å¾—åˆ°ä¿ç•™ã€‚

## ğŸ¯ **ä¼˜åŒ–åçš„é•¿æŒ‰é€‰æ‹©æ¨¡å¼æ–¹æ¡ˆ**

### **æ ¸å¿ƒç‰¹æ€§**

#### **1. åŒé‡é€‰æ‹©æœºåˆ¶**
- **é•¿æŒ‰æ¨¡å¼**ï¼šé€‚ç”¨äºæ‰€æœ‰å¹³å°ï¼Œç®€å•ç›´è§‚
- **Ctrl+ç‚¹å‡»æ¨¡å¼**ï¼šä¿ç•™æ¡Œé¢ç«¯çš„ç†Ÿæ‚‰æ“ä½œ
- **æ™ºèƒ½å…±å­˜**ï¼šä¸¤ç§æ¨¡å¼äº’ä¸å†²çªï¼Œå¯ä»¥æ··åˆä½¿ç”¨

#### **2. é€‰æ‹©æ¨¡å¼çŠ¶æ€**
```javascript
class SelectionModeManager {
    constructor() {
        this.isActive = false;        // æ˜¯å¦å¤„äºé€‰æ‹©æ¨¡å¼
        this.selectionMethod = null;  // 'longpress' æˆ– 'ctrl_click'
        this.selectedPhotos = new Set();
    }
}
```

### **è¯¦ç»†äº¤äº’é€»è¾‘**

#### **è¿›å…¥é€‰æ‹©æ¨¡å¼çš„æ¡ä»¶**
```javascript
// æ¡ä»¶1ï¼šé•¿æŒ‰ä»»æ„ç…§ç‰‡ï¼ˆæ‰€æœ‰å¹³å°ï¼‰
if (isLongPressDetected) {
    enterSelectionMode('longpress', triggerPhotoId);
    return;
}

// æ¡ä»¶2ï¼šæ¡Œé¢ç«¯Ctrl+ç‚¹å‡»ï¼ˆä»…å½“ä¸åœ¨é€‰æ‹©æ¨¡å¼æ—¶ï¼‰
if (isDesktop && event.ctrlKey && !selectionMode.isActive) {
    enterSelectionMode('ctrl_click', clickedPhotoId);
    return;
}

// æ¡ä»¶3ï¼šé€‰æ‹©æ¨¡å¼ä¸‹æ™®é€šç‚¹å‡»ï¼ˆåˆ‡æ¢é€‰æ‹©çŠ¶æ€ï¼‰
if (selectionMode.isActive) {
    togglePhotoSelection(clickedPhotoId);
    return;
}

// æ¡ä»¶4ï¼šæ­£å¸¸ç‚¹å‡»ï¼ˆæŸ¥çœ‹è¯¦æƒ…ç­‰åŸæœ‰åŠŸèƒ½ï¼‰
performNormalPhotoClick(clickedPhotoId);
```

#### **é€‰æ‹©æ¨¡å¼çš„ç®¡ç†**
```javascript
function enterSelectionMode(method, initialPhotoId = null) {
    // æ ‡è®°é€‰æ‹©æ¨¡å¼æ¿€æ´»
    selectionMode.isActive = true;
    selectionMode.selectionMethod = method;
    
    // æ˜¾ç¤ºé€‰æ‹©UI
    showSelectionUI();
    
    // å¦‚æœæœ‰åˆå§‹ç…§ç‰‡ï¼Œè‡ªåŠ¨é€‰ä¸­
    if (initialPhotoId) {
        selectionMode.selectedPhotos.add(initialPhotoId);
        updatePhotoSelectionUI(initialPhotoId, true);
    }
    
    // æ˜¾ç¤ºé€‰æ‹©æ¨¡å¼å·¥å…·æ 
    showSelectionToolbar();
    
    // æ ¹æ®è¿›å…¥æ–¹å¼æ˜¾ç¤ºä¸åŒæç¤º
    if (method === 'longpress') {
        showToast('å·²è¿›å…¥é€‰æ‹©æ¨¡å¼ï¼Œé•¿æŒ‰è¿›å…¥æˆ–ç‚¹å‡»ç©ºç™½åŒºåŸŸé€€å‡º');
    } else if (method === 'ctrl_click') {
        showToast('å·²è¿›å…¥é€‰æ‹©æ¨¡å¼ï¼Œç»§ç»­Ctrl+ç‚¹å‡»é€‰æ‹©æˆ–ç‚¹å‡»ç©ºç™½åŒºåŸŸé€€å‡º');
    }
}

function exitSelectionMode() {
    selectionMode.isActive = false;
    selectionMode.selectionMethod = null;
    
    hideSelectionUI();
    hideSelectionToolbar();
    clearAllSelections();
    
    showToast('å·²é€€å‡ºé€‰æ‹©æ¨¡å¼');
}
```

### **å¹³å°ç‰¹å®šçš„ä¼˜åŒ–**

#### **æ¡Œé¢ç«¯äº¤äº’**
```javascript
// ä¿ç•™Ctrl+ç‚¹å‡»åŠŸèƒ½
document.addEventListener('click', (e) => {
    const photoCard = e.target.closest('.photo-card');
    if (!photoCard) return;
    
    const photoId = photoCard.dataset.photoId;
    
    // Ctrl+ç‚¹å‡»ï¼šè¿›å…¥é€‰æ‹©æ¨¡å¼å¹¶é€‰æ‹©ç…§ç‰‡
    if ((e.ctrlKey || e.metaKey) && !selectionMode.isActive) {
        e.preventDefault();
        enterSelectionMode('ctrl_click', photoId);
        return;
    }
    
    // é€‰æ‹©æ¨¡å¼ä¸‹ï¼šæ™®é€šç‚¹å‡»åˆ‡æ¢é€‰æ‹©çŠ¶æ€
    if (selectionMode.isActive) {
        e.preventDefault();
        togglePhotoSelection(photoId);
        return;
    }
    
    // éé€‰æ‹©æ¨¡å¼ï¼šæ‰§è¡ŒåŸæœ‰åŠŸèƒ½
    performNormalPhotoClick(photoId);
});

// é•¿æŒ‰æ”¯æŒï¼ˆæ¡Œé¢ç«¯å¯é€‰ï¼‰
document.addEventListener('contextmenu', (e) => {
    // å¯ä»¥é€‰æ‹©å³é”®èœå•è¿›å…¥é€‰æ‹©æ¨¡å¼
    // æˆ–è€…ä¿æŒé•¿æŒ‰æ”¯æŒ
});
```

#### **æ‰‹æœºç«¯äº¤äº’**
```javascript
// ä¸»è¦ä½¿ç”¨é•¿æŒ‰æ¨¡å¼
document.addEventListener('touchstart', (e) => {
    const photoCard = e.target.closest('.photo-card');
    if (!photoCard) return;
    
    startLongPressTimer(() => {
        const photoId = photoCard.dataset.photoId;
        enterSelectionMode('longpress', photoId);
        
        // è§¦è§‰åé¦ˆ
        if (navigator.vibrate) {
            navigator.vibrate(50);
        }
    });
});

document.addEventListener('touchend', (e) => {
    clearLongPressTimer();
    
    // å¦‚æœæ˜¯é€‰æ‹©æ¨¡å¼ä¸‹çš„çŸ­ç‚¹å‡»
    if (selectionMode.isActive) {
        const photoCard = e.target.closest('.photo-card');
        if (photoCard) {
            const photoId = photoCard.dataset.photoId;
            togglePhotoSelection(photoId);
        }
    }
});
```

### **ç”¨æˆ·ä½“éªŒæµç¨‹**

#### **æ¡Œé¢ç«¯å®Œæ•´æµç¨‹**
```
æ–¹æ³•1ï¼ˆæ–°æ–¹å¼ï¼‰ï¼š
1. é•¿æŒ‰ä»»æ„ç…§ç‰‡ â†’ è¿›å…¥é€‰æ‹©æ¨¡å¼ â†’ è‡ªåŠ¨é€‰ä¸­è¯¥ç…§ç‰‡
2. ç»§ç»­ç‚¹å‡»å…¶ä»–ç…§ç‰‡é€‰æ‹©/å–æ¶ˆé€‰æ‹©
3. ç‚¹å‡»ç©ºç™½åŒºåŸŸé€€å‡ºé€‰æ‹©æ¨¡å¼

æ–¹æ³•2ï¼ˆä¿ç•™åŸæœ‰ï¼‰ï¼š
1. Ctrl+ç‚¹å‡»ç…§ç‰‡ â†’ è¿›å…¥é€‰æ‹©æ¨¡å¼ â†’ é€‰ä¸­è¯¥ç…§ç‰‡
2. ç»§ç»­Ctrl+ç‚¹å‡»å…¶ä»–ç…§ç‰‡è¿›è¡Œå¤šé€‰
3. ç‚¹å‡»ç©ºç™½åŒºåŸŸé€€å‡ºé€‰æ‹©æ¨¡å¼

æ–¹æ³•3ï¼ˆæ··åˆä½¿ç”¨ï¼‰ï¼š
1. å…ˆç”¨Ctrl+ç‚¹å‡»é€‰å‡ å¼ ç…§ç‰‡
2. å†é•¿æŒ‰è¿›å…¥é€‰æ‹©æ¨¡å¼ç»§ç»­é€‰æ‹©
3. æ‰€æœ‰é€‰æ‹©éƒ½ä¼šä¿ç•™
```

#### **æ‰‹æœºç«¯æµç¨‹**
```
1. é•¿æŒ‰ä»»æ„ç…§ç‰‡ â†’ æŒ¯åŠ¨åé¦ˆ â†’ è¿›å…¥é€‰æ‹©æ¨¡å¼ â†’ è‡ªåŠ¨é€‰ä¸­è¯¥ç…§ç‰‡
2. ç»§ç»­è½»è§¦å…¶ä»–ç…§ç‰‡è¿›è¡Œé€‰æ‹©/å–æ¶ˆé€‰æ‹©
3. ç‚¹å‡»ç©ºç™½åŒºåŸŸæˆ–"å®Œæˆ"æŒ‰é’®é€€å‡ºé€‰æ‹©æ¨¡å¼
```

### **è§†è§‰è®¾è®¡ä¼˜åŒ–**

#### **é€‰æ‹©æ¡†è®¾è®¡**
```css
/* æ™®é€šçŠ¶æ€ - éšè—é€‰æ‹©æ¡† */
.photo-select-checkbox {
    display: none;
}

/* é€‰æ‹©æ¨¡å¼ - æ˜¾ç¤ºé€‰æ‹©æ¡† */
.selection-mode .photo-select-checkbox {
    display: block;
    position: absolute;
    top: 8px;
    left: 8px;
    z-index: 10;
    width: 24px;
    height: 24px;
}

/* å·²é€‰ä¸­çŠ¶æ€ */
.photo-card.selected {
    box-shadow: 0 0 0 3px #007bff;
    position: relative;
}

.photo-card.selected::after {
    content: '';
    position: absolute;
    top: 8px;
    left: 8px;
    width: 24px;
    height: 24px;
    background: #007bff;
    border-radius: 2px;
    mask: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath d='M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 0 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z'/%3e%3c/svg%3e") center/contain no-repeat;
    -webkit-mask: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath d='M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 0 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z'/%3e%3c/svg%3e") center/contain no-repeat;
}
```

#### **çŠ¶æ€æç¤º**
```javascript
function showSelectionModeIndicator() {
    const indicator = document.createElement('div');
    indicator.id = 'selection-mode-indicator';
    indicator.innerHTML = `
        <div class="alert alert-info alert-dismissible fade show" role="alert">
            <i class="bi bi-check-square me-2"></i>
            <strong>é€‰æ‹©æ¨¡å¼å·²æ¿€æ´»</strong>
            ${selectionMode.selectionMethod === 'longpress' 
                ? 'ç‚¹å‡»é€‰æ‹©ç…§ç‰‡ï¼Œç‚¹å‡»ç©ºç™½åŒºåŸŸé€€å‡º' 
                : 'ç»§ç»­Ctrl+ç‚¹å‡»é€‰æ‹©ç…§ç‰‡ï¼Œæˆ–ç‚¹å‡»ç©ºç™½åŒºåŸŸé€€å‡º'}
            <button type="button" class="btn-close" onclick="exitSelectionMode()"></button>
        </div>
    `;
    document.body.appendChild(indicator);
}
```

### **åŠŸèƒ½å¢å¼º**

#### **æ™ºèƒ½é€‰æ‹©æç¤º**
```javascript
// æ ¹æ®å¹³å°æ˜¾ç¤ºä¸åŒçš„æ“ä½œæç¤º
function getSelectionInstructions() {
    if (isMobile()) {
        return 'é•¿æŒ‰è¿›å…¥é€‰æ‹©æ¨¡å¼ï¼Œç‚¹å‡»é€‰æ‹©ç…§ç‰‡';
    } else {
        return 'é•¿æŒ‰æˆ–Ctrl+ç‚¹å‡»è¿›å…¥é€‰æ‹©æ¨¡å¼ï¼Œé€‰æ‹©ç…§ç‰‡åå¯è¿›è¡Œæ‰¹é‡åˆ†æ';
    }
}

// æ ¹æ®é€‰æ‹©æ–¹æ³•æä¾›ä¸åŒçš„å¿«æ·é”®æç¤º
function getShortcutHints() {
    const hints = [];
    
    if (!isMobile()) {
        hints.push('Ctrl+ç‚¹å‡»é€‰æ‹©ç…§ç‰‡');
        hints.push('é•¿æŒ‰è¿›å…¥é€‰æ‹©æ¨¡å¼');
    } else {
        hints.push('é•¿æŒ‰è¿›å…¥é€‰æ‹©æ¨¡å¼');
    }
    
    hints.push('ç‚¹å‡»ç©ºç™½åŒºåŸŸé€€å‡ºé€‰æ‹©æ¨¡å¼');
    hints.push('é€‰æ‹©ç…§ç‰‡åå¯è¿›è¡Œæ‰¹é‡åˆ†æ');
    
    return hints;
}
```

#### **é€‰æ‹©å†å²è®°å¿†**
```javascript
// è®°ä½ç”¨æˆ·çš„é€‰æ‹©åå¥½
class SelectionPreferences {
    constructor() {
        this.lastMethod = localStorage.getItem('photo-selection-method') || 'longpress';
        this.showHints = localStorage.getItem('photo-selection-hints') !== 'false';
    }
    
    recordMethod(method) {
        this.lastMethod = method;
        localStorage.setItem('photo-selection-method', method);
    }
    
    shouldShowHints() {
        return this.showHints;
    }
}
```

### **å…¼å®¹æ€§ä¿è¯**

#### **å‘åå…¼å®¹**
- âœ… ä¿ç•™æ‰€æœ‰ç°æœ‰çš„Ctrl+ç‚¹å‡»åŠŸèƒ½
- âœ… ä¸ç ´åç°æœ‰çš„æ‚¬æµ®æŒ‰é’®åŠŸèƒ½
- âœ… ä¿æŒè¯¦æƒ…æŸ¥çœ‹çš„å“åº”é€Ÿåº¦

#### **å‘å‰å…¼å®¹**
- âœ… æ”¯æŒæœªæ¥çš„å¤šé€‰æ“ä½œæ‰©å±•
- âœ… ä¸ºæ‰¹é‡æ“ä½œé¢„ç•™æ¥å£
- âœ… æ”¯æŒç¬¬ä¸‰æ–¹æ‰©å±•

### **æ€»ç»“**

è¿™ä¸ªä¼˜åŒ–æ–¹æ¡ˆå®Œç¾å¹³è¡¡äº†ï¼š

**ğŸ¯ ç®€å•æ€§**ï¼šé•¿æŒ‰æä¾›æœ€ç›´è§‚çš„é€‰æ‹©æ–¹å¼
**ğŸ”„ å…¼å®¹æ€§**ï¼šä¿ç•™æ¡Œé¢ç«¯çš„Ctrl+ç‚¹å‡»ä¹ æƒ¯
**ğŸ“± è·¨å¹³å°**ï¼šå®Œç¾æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
**âš¡ é«˜æ•ˆæ€§**ï¼šæ”¯æŒå¿«é€Ÿæ‰¹é‡é€‰æ‹©æ“ä½œ

ç°åœ¨ç”¨æˆ·å¯ä»¥ï¼š
- **æ¡Œé¢ç«¯**ï¼šä½¿ç”¨ç†Ÿæ‚‰çš„Ctrl+ç‚¹å‡»ï¼Œæˆ–å°è¯•æ›´ç®€å•é•¿æŒ‰
- **æ‰‹æœºç«¯**ï¼šä½¿ç”¨è‡ªç„¶çš„é•¿æŒ‰æ“ä½œ
- **æ‰€æœ‰å¹³å°**ï¼šäº«å—ä¸€è‡´çš„é€‰æ‹©ä½“éªŒ

æ‚¨è§‰å¾—è¿™ä¸ªå¹³è¡¡æ–¹æ¡ˆå¦‚ä½•ï¼Ÿå¦‚æœéœ€è¦æˆ‘å¼€å§‹å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘å¯ä»¥æä¾›å…·ä½“çš„ä»£ç ä¿®æ”¹æ–¹æ¡ˆï¼ ğŸš€âœ¨