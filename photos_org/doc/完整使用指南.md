# 家庭版智能照片系统 - 完整使用指南

## 📖 目录

1. [系统概述](#系统概述)
2. [快速开始](#快速开始)
3. [多设备访问指南](#多设备访问指南)
4. [照片导入与管理](#照片导入与管理)
5. [搜索与筛选技巧](#搜索与筛选技巧)
6. [照片展示区使用](#照片展示区使用)
7. [系统配置管理](#系统配置管理)
8. [API密钥配置](#api密钥配置)
9. [常见问题解答](#常见问题解答)
10. [技术支持](#技术支持)

---

## 系统概述

### �� 核心亮点

**智能照片系统**是专为家庭用户打造的照片管理解决方案，让您告别照片的烦恼！

#### 家庭组网，随时随地访问
- **一台主机，多端同步**：随时随地用手机拍照片，回家就能同步到家庭照片库
- **多设备无缝访问**：台式机、笔记本、平板、手机，通过浏览器随时浏览家庭所有珍贵回忆
- **触摸友好**：完美支持触摸屏操作，小朋友和老人也能轻松使用
- **家庭共享**：全家人同时访问同一个照片库，共同整理家庭回忆

#### AI智能分析，解放双手
- **自动识别内容**：AI一眼看懂照片，自动生成详细描述文字
- **智能分类整理**：自动识别聚会、旅行、生日等场景，一键归类
- **自动打标签**：智能识别人物、地点、物品，自动添加标签

#### 强大的搜索功能
- **多种搜索方式**：支持按日期、节假日、人物、场景等条件搜索
- **相似照片查找**：快速找出重复照片，一键清理节省空间
- **智能推荐**：根据您的习惯，智能推荐相关照片

---

## 快速开始

### 1. 环境准备

#### 硬件要求
- **处理器**：Intel i5/Ryzen 5及以上（推荐i7/Ryzen 7）
- **内存**：8GB RAM及以上（推荐16GB）
- **存储**：100GB可用空间（推荐SSD，提高访问速度）
- **网络**：稳定的互联网连接（用于AI分析，支持离线缓存）

#### 软件要求
- **Python**：3.8 - 3.11（推荐3.9+）
- **操作系统**：Windows 10/11、macOS 10.15+、Ubuntu 18.04+
- **浏览器**：Chrome 90+、Firefox 88+、Safari 14+、Edge 90+

### 2. 安装与配置

```bash
# 克隆项目
git clone <项目仓库地址>
cd photos_org

# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate

# 安装依赖
pip install --upgrade pip
pip install -r requirements.txt
```

### 3. 启动系统

```bash
# 启动服务
python main.py

# 系统将在 http://127.0.0.1:8000 启动
# 访问 http://127.0.0.1:8000 开始使用
```

### 4. 首次使用

1. **访问系统配置页面**：http://127.0.0.1:8000/settings
2. **配置照片存储目录和数据库位置**
3. **配置AI服务**（详见[API密钥配置](#api密钥配置)）
4. **导入照片并开始AI分析**
5. **享受智能照片管理体验！**

---

## 多设备访问指南

### 一台主机，多端同步

#### 主机设置
1. **确保主机网络连接**：确保主机连接到家庭网络
2. **获取主机IP地址**：
   - Windows：在命令提示符中输入 `ipconfig`
   - macOS/Linux：在终端中输入 `ifconfig` 或 `ip addr`
3. **记录主机IP**：例如 `192.168.1.100`

#### 客户端连接
1. **确保设备在同一网络**：手机、平板、其他电脑需连接到同一WiFi网络
2. **访问系统**：在浏览器中输入 `http://主机IP:8000`
   - 例如：`http://192.168.1.100:8000`
3. **开始使用**：所有设备都能访问同一个照片库

#### 多设备无缝访问
- **实时同步**：在一台设备上导入的照片，其他设备立即可见
- **统一界面**：所有设备使用相同的界面和功能
- **触摸优化**：手机和平板完美支持触摸操作
- **响应式设计**：自动适配不同屏幕尺寸

#### 家庭共享使用
- **多人同时访问**：支持多个家庭成员同时浏览照片
- **协作整理**：可以同时进行照片分类和标签管理
- **权限控制**：所有用户具有相同的访问权限

---

## 照片导入与管理

### 照片导入方式

#### 1. 单文件上传
- 点击"导入照片"按钮
- 选择要上传的照片文件
- 支持多选，可同时上传多张照片
- 支持格式：JPG、PNG、GIF、HEIC、TIFF、WebP、BMP

#### 2. 文件夹扫描
- 选择"扫描文件夹"模式
- 选择包含照片的文件夹
- 系统会自动扫描所有子目录
- 支持递归扫描，处理大量照片

#### 3. 智能处理
- 导入后自动进行AI分析
- 自动生成缩略图
- 自动提取EXIF信息
- 自动进行质量评估

### 照片管理功能

#### 浏览照片
- **网格视图**：以紧凑的网格形式展示照片缩略图
- **列表视图**：以列表形式展示照片，包含更多详细信息
- **分页浏览**：支持分页显示，可调整每页显示数量

#### 照片选择
- **查看详情**：点击照片查看大图和详细信息
- **多选**：按住 `Ctrl` 键点击多张照片进行选择
- **全选**：点击"全选"按钮选择当前页所有照片
- **取消选择**：点击"取消选择"按钮清空选择，或按住Ctrl键再次点击照片

#### 批量操作
- **批量删除**：选择多张照片进行批量删除
- **批量分类**：为多张照片设置相同分类
- **批量标签**：为多张照片添加相同标签

---

## 搜索与筛选技巧

### 基础搜索

#### 搜索范围
- **全部内容**：文件名、标签、分类、描述、AI分析
- **文件名**：仅搜索照片文件名
- **用户描述**：仅搜索用户添加的描述
- **AI分析结果**：仅搜索AI自动分析的内容

#### 搜索语法
- **关键词搜索**：`花朵` - 搜索包含"花朵"的照片
- **多词搜索**：`Apple iPhone` - 搜索包含"Apple"和"iPhone"的照片
- **精确搜索**：`"Apple iPhone"` - 精确匹配"Apple iPhone"
- **前缀搜索**：`花朵%` - 以"花朵"开头的词（推荐）

### 高级搜索

#### 逻辑操作符
- **AND操作**：`花朵 AND 盆栽` - 同时包含"花朵"和"盆栽"
- **OR操作**：`花朵 OR 植物` - 包含"花朵"或"植物"
- **NOT操作**：`花朵 NOT 盆栽` - 包含"花朵"但不包含"盆栽"

#### 筛选条件
- **标签筛选**：按照片标签进行筛选
- **分类筛选**：按照片分类进行筛选
- **拍摄日期**：按时间范围筛选（今天、本周、本月、今年、自定义）
- **质量等级**：按照片质量筛选（优秀、良好、一般、较差、很差）
- **排序方式**：按质量分数、拍摄时间、导入时间、文件名排序

### 相似照片搜索

#### 相似度设置
- **相似度阈值**：控制相似照片的识别敏感度（推荐0.6）
- **重复检测阈值**：控制重复照片的识别敏感度（推荐5）

#### 搜索技巧
- 点击照片的"相似照片"按钮
- 系统会基于AI分析结果推荐相似照片
- 支持精确相似度搜索

---

## 照片展示区使用

### 视图模式

#### 网格视图
- **图标**：<i class="bi bi-grid-3x3-gap"></i>
- **功能**：以紧凑的网格形式展示照片缩略图，适合快速浏览大量照片

#### 列表视图
- **图标**：<i class="bi bi-list"></i>
- **功能**：以列表形式展示照片，可能包含更多详细信息

### 照片选择

#### 查看详情
- **图标**：<i class="bi bi-eye"></i>
- **操作**：点击照片查看大图和详细信息

#### 多选功能
- **图标**：<i class="bi bi-cursor-fill"></i>
- **操作**：按住 `Ctrl` 键点击多张照片进行选择

#### 全选功能
- **图标**：<i class="bi bi-check-all"></i>
- **操作**：点击"全选"按钮选择当前页所有照片

#### 取消选择
- **图标**：<i class="bi bi-x-circle"></i>
- **操作**：点击"取消选择"按钮清空选择，或按住Ctrl键再次点击照片

### 操作按钮

#### 全选
- **图标**：<i class="bi bi-check-all"></i>
- **功能**：选中当前页面所有照片

#### 取消选择
- **图标**：<i class="bi bi-x-circle"></i>
- **功能**：取消所有已选中的照片

#### 删除选中
- **图标**：<i class="bi bi-trash"></i>
- **功能**：永久删除所有选中的照片（谨慎操作）

### 照片交互

#### 悬停效果
- **图标**：<i class="bi bi-mouse"></i>
- **功能**：鼠标悬停时显示四个操作按钮

#### 查看详情
- **图标**：<i class="bi bi-eye"></i>
- **功能**：点击查看照片大图和详细信息

#### 编辑
- **图标**：<i class="bi bi-pencil"></i>
- **功能**：点击编辑照片标签和描述信息

#### 删除
- **图标**：<i class="bi bi-trash"></i>
- **功能**：点击删除单张照片

#### 相似照片
- **图标**：<i class="bi bi-search"></i>
- **功能**：点击搜索相似的照片

### 照片信息

#### 缩略图
- **图标**：<i class="bi bi-image"></i>
- **内容**：照片的预览图

#### 质量等级
- **图标**：<i class="bi bi-star"></i>
- **内容**：照片的质量评估（优秀、良好、一般、较差、很差）

#### 标签
- **图标**：<i class="bi bi-tags"></i>
- **内容**：照片的标签信息

#### 拍摄时间
- **图标**：<i class="bi bi-clock"></i>
- **内容**：照片的拍摄日期和时间

### 分页导航

#### 分页信息
- **图标**：<i class="bi bi-info-square"></i>
- **内容**：显示当前页数和总页数

#### 每页显示数量
- **图标**：<i class="bi bi-list-ol"></i>
- **内容**：可以调整每页显示的照片数量

#### 翻页按钮
- **图标**：<i class="bi bi-chevron-left"></i> <i class="bi bi-chevron-right"></i>
- **功能**：可以快速跳转到其他页面

---

## 系统配置管理

### 配置管理概述

配置管理是系统提供的参数调整功能，让您可以根据个人需求自定义系统行为，包括：
- **存储位置**：选择照片和数据库的存储位置
- **AI服务**：配置AI分析功能
- **界面设置**：调整显示效果
- **搜索设置**：优化搜索体验

### 访问配置管理

1. 启动系统后，在浏览器中访问：`http://127.0.0.1:8000/settings`
2. 或者点击系统界面右上角的"设置"按钮

### AI服务设置

#### 大模型选择
- **作用**：选择用于照片分析的AI模型
- **可选模型**：qwen-vl-plus、qwen-vl-plus-latest、qwen-vl-plus-2025-08-15、qwen-vl-plus-2025-05-07、qwen-vl-plus-2025-01-25
- **推荐设置**：qwen-vl-plus（稳定版本）
- **如何设置**：从下拉菜单中选择，页面会显示当前值和默认值
- **实时更新**：选择后会立即更新显示的当前值

#### API密钥
- **作用**：访问AI服务的身份验证
- **获取方式**：详见[API密钥配置](#api密钥配置)
- **安全提示**：优先使用环境变量DASHSCOPE_API_KEY，避免在配置文件中明文存储
- **帮助功能**：点击"如何获取API密钥"按钮可查看详细说明
- **当前状态**：页面会显示API密钥是否已设置

### 存储设置

#### 照片存储目录
- **作用**：设置照片文件的存储位置
- **推荐位置**：`D:\Photos` 或 `C:\Users\用户名\Pictures\智能照片`
- **如何设置**：
  1. 在文本框中直接输入路径，或点击文件夹图标按钮
  2. 点击文件夹图标会在本地打开目录选择对话框
  3. 系统会自动填入完整路径
- **重要提醒**：更改存储目录前，请先将原目录下的所有照片数据复制到新目录
- **远程访问限制**：此功能仅限本地访问，远程访问时不可见
- **当前值显示**：页面会显示当前配置值和默认值

#### 照片大小限制
- **作用**：限制单张照片的最大文件大小
- **可选值**：25MB、50MB、100MB、200MB
- **默认值**：50MB
- **如何设置**：从下拉菜单中选择
- **当前值显示**：页面会显示当前配置值和默认值

#### 缩略图质量
- **作用**：控制缩略图的压缩质量
- **推荐值**：50%（适合大多数场景，减小存储空间）
- **范围**：1-100%
- **如何设置**：拖动滑块调整，实时显示当前值
- **当前值显示**：页面会显示当前配置值和默认值

#### 缩略图尺寸
- **作用**：控制缩略图的显示尺寸
- **推荐值**：300像素（适合大多数屏幕）
- **范围**：100-1000像素
- **如何设置**：拖动滑块调整，实时显示当前值
- **当前值显示**：页面会显示当前配置值和默认值

### 界面设置

#### 每页显示照片数
- **作用**：控制照片列表每页显示的照片数量
- **可选值**：6张、12张、18张、24张、30张
- **默认值**：12张
- **如何设置**：从下拉菜单中选择
- **当前值显示**：页面会显示当前配置值和默认值

#### 相似照片显示数量
- **作用**：控制相似照片推荐的数量
- **可选值**：4张、8张、12张
- **默认值**：8张
- **如何设置**：从下拉菜单中选择
- **当前值显示**：页面会显示当前配置值和默认值

### 搜索设置

#### 相似度阈值
- **作用**：控制相似照片的识别敏感度
- **推荐值**：0.6（平衡准确性和召回率）
- **范围**：0.0-1.0
- **如何设置**：拖动滑块调整，实时显示当前值
- **当前值显示**：页面会显示当前配置值和默认值

#### 重复检测阈值
- **作用**：控制重复照片的识别敏感度
- **推荐值**：5（适合大多数情况）
- **范围**：1-20
- **如何设置**：拖动滑块调整，实时显示当前值
- **当前值显示**：页面会显示当前配置值和默认值

### 配置操作

#### 基本操作流程
1. **打开配置页面**：访问 `http://127.0.0.1:8000/settings`
2. **查看配置状态**：页面会显示每个配置项的当前值和默认值
3. **修改配置参数**：根据需要调整各项参数
4. **保存配置**：点击"保存配置"按钮，系统会弹出确认对话框

#### 高级操作功能
- **重置为默认值**：点击导航栏中的"重置为默认"按钮
- **导出配置**：点击导航栏中的"导出配置"按钮
- **获取默认配置值**：系统会自动从config_default.json加载默认值

---

## API密钥配置

### 获取API Key

#### 1. 开通阿里云百炼的模型服务
使用阿里云主账号访问[阿里云百炼大模型服务平台](https://bailian.console.aliyun.com/?tab=model#/model-market)，如果页面顶部显示开通提示，您需开通阿里云百炼模型服务，以获得[新人免费额度](https://help.aliyun.com/zh/model-studio/new-free-quota)。

**重要提示**：开通阿里云百炼不会产生费用，仅模型调用（超出免费额度后）、模型部署、模型调优会产生相应[计费](https://help.aliyun.com/zh/model-studio/billing-for-model-studio)。如果页面顶部未显示开通提示，则表示您已经开通。

**实名认证**：如果开通服务时提示"您尚未进行实名认证"，请先进行[实名认证](https://help.aliyun.com/zh/account/verify-your-identity-individual-account)。

#### 2. 获取API Key
**重要**：需使用[主账号](https://help.aliyun.com/zh/model-studio/permission-management-overview#24ca2dad7djzs)，或具备`管理员`或`API-Key`[页面权限](https://help.aliyun.com/zh/model-studio/member-management#febd776ce5lbx)的[子账号](https://help.aliyun.com/zh/model-studio/permission-management-overview#24ca2dad7djzs)操作。

开通阿里云百炼后，您需要手动创建API Key，系统不会自动生成。

**步骤1：前往密钥管理页面**
前往[密钥管理](https://bailian.console.aliyun.com/?tab=model#/api-key)页面，在**API-Key**页签下单击**创建API-KEY**。

**步骤2：填写API Key信息**
在**创建API-KEY**弹窗中，选择API Key的**归属账号**及**归属业务空间**，填写**描述信息**，并单击**确定**。

- **归属账号**：可选择主账号或子账号（当人员离职或岗位变动时，只需将其子账号[移出业务空间](https://help.aliyun.com/zh/model-studio/member-management#baa5507e10prj)，对应API Key将自动失效，不再具备调用权限）。
- **归属业务空间**：通常选择**[默认业务空间](https://help.aliyun.com/zh/model-studio/use-workspace#0358d9b5079ck)**（即主账号空间）。若需管控某类用户可调用的模型，或对模型调用的费用进行分账，请创建/选择列表中的[子业务空间](https://help.aliyun.com/zh/model-studio/use-workspace#0358d9b5079ck)。详见[子业务空间的模型调用](https://help.aliyun.com/zh/model-studio/model-calling-in-sub-workspace)。

**步骤3：获取API Key**
点击API Key旁的图标获取该API Key。

**说明**：主账号可以查看全部API Key，子账号仅能查看自己创建的API Key。

#### 3. API Key时效性说明
通过[API-Key](https://bailian.console.aliyun.com/?tab=model#/api-key)页面创建的API Key永久有效，手动删除后即失效。

### 配置API Key到环境变量

**说明**：
- 此方式配置的环境变量永久生效。
- 修改系统环境变量需具备管理员权限。
- 配置环境变量后不会立即影响已经打开的命令窗口、IDE或其他正在运行的应用程序。您需要重新启动这些程序或者打开新的命令行使环境变量生效。

**步骤1：打开系统属性**
在Windows系统桌面中按`Win+Q`键，在搜索框中搜索**编辑系统环境变量**，单击打开**系统属性**界面。

**步骤2：添加环境变量**
在**系统属性**窗口，单击**环境变量**，然后在**系统变量**区域下单击**新建**，**变量名**填入`DASHSCOPE_API_KEY`，**变量值**填入您的DashScope API Key。

**步骤3：确认配置**
依次单击三个窗口的**确定**，关闭系统属性配置页面，完成环境变量配置。

**步骤4：验证配置**
打开CMD（命令提示符）窗口或Windows PowerShell窗口，执行如下命令检查环境变量是否生效。

**CMD查询命令**：
```cmd
echo %DASHSCOPE_API_KEY%
```

**Windows PowerShell查询命令**：
```powershell
echo $env:DASHSCOPE_API_KEY
```

### 在系统中使用API Key

#### 方式1：使用环境变量（推荐）
在API密钥输入框中留空，系统会自动使用环境变量`DASHSCOPE_API_KEY`的值。

**优点**：这是推荐的方式，更安全且便于管理。

#### 方式2：直接输入
在API密钥输入框中直接输入您的API Key。

**注意**：这种方式会将API Key保存在配置文件中，请注意安全性。

---

## 常见问题解答

### 系统使用问题

**Q: 如何实现多设备访问？**
A: 确保所有设备连接到同一WiFi网络，在浏览器中输入 `http://主机IP:8000` 即可访问。主机IP可通过 `ipconfig`（Windows）或 `ifconfig`（macOS/Linux）命令获取。

**Q: 修改配置后为什么没有生效？**
A: 修改配置后需要点击"保存配置"按钮，系统会重新加载配置使其生效。

**Q: 如何恢复默认配置？**
A: 点击导航栏中的"重置为默认"按钮，系统会将所有配置恢复为默认值，然后需要再次保存。

**Q: 配置保存失败怎么办？**
A: 检查网络连接和文件权限，确保系统有写入配置文件的权限。

**Q: 如何备份我的配置？**
A: 点击导航栏中的"导出配置"按钮，可以下载完整的配置文件用于备份。

### 照片管理问题

**Q: 支持哪些照片格式？**
A: 支持JPG、PNG、GIF、HEIC、TIFF、WebP、BMP等常见图片格式。

**Q: 如何批量导入照片？**
A: 可以使用"扫描文件夹"功能，选择包含照片的文件夹，系统会自动扫描所有子目录。

**Q: 如何搜索相似照片？**
A: 点击照片的"相似照片"按钮，或使用相似度搜索功能，系统会基于AI分析结果推荐相似照片。

**Q: 如何删除重复照片？**
A: 使用相似照片搜索功能找到重复照片，然后选择要删除的照片进行批量删除。

### 配置相关问题

**Q: 为什么无法选择目录？**
A: 此功能仅限本地访问，如果您通过远程访问，可能无法使用目录选择功能。请在本地主机上访问配置页面。

**Q: 选择的路径显示不正确？**
A: 系统会自动转换为绝对路径并验证有效性，这是正常现象。

**Q: 如何手动输入路径？**
A: 可以在文本框中直接输入完整路径，系统会自动验证路径的有效性。

### 性能相关问题

**Q: 缩略图质量设置多少合适？**
A: 建议设置为50%，这是系统默认值，既能保证质量又能显著减小存储空间。

**Q: 每页显示多少照片合适？**
A: 建议设置为12张，这是系统默认值，适合大多数屏幕尺寸。

**Q: 相似度阈值设置多少合适？**
A: 建议设置为0.6，这是系统默认值，能在准确性和召回率之间取得良好平衡。

**Q: 重复检测阈值设置多少合适？**
A: 建议设置为5，这是系统默认值，适合大多数照片重复检测场景。

---

## 技术支持

### 获取帮助

1. **查看文档**：首先查看本帮助页面的相关章节
2. **检查日志**：查看 `logs/app.log` 文件中的错误信息
3. **运行诊断**：使用 `utilities/diagnose_system.py` 进行系统诊断
4. **提交Issue**：在 GitHub Issues 中详细描述问题

### 问题报告模板

```markdown
**问题描述**：
**复现步骤**：
**期望行为**：
**实际行为**：
**系统环境**：
- 操作系统：
- Python版本：
- 浏览器版本：
**错误日志**：
```

### 最佳实践建议

#### 存储位置规划
1. **照片存储目录**：选择空间充足的磁盘分区，建议使用SSD提高访问速度，定期备份重要照片
2. **数据库文件位置**：与照片存储目录放在同一位置，便于整体备份和迁移，定期备份数据库文件

#### 性能优化建议
1. **缩略图设置**：质量50%，尺寸300像素，平衡显示效果和存储空间
2. **界面设置**：每页12张照片，相似照片8张，热门标签和分类各10个
3. **搜索设置**：相似度阈值0.6，重复检测阈值5

#### 安全建议
1. **API密钥管理**：使用环境变量存储API密钥，不要在配置文件中明文存储，定期更换API密钥
2. **数据备份**：定期备份照片和数据库，使用系统提供的备份功能，将备份存储在不同位置

---

**版本**：v2.0.0  
**最后更新**：2025年1月20日  
**维护状态**：积极维护中 ��

这个帮助页面整合了所有相关文档的内容，包括：
- README.md 的快速开始和系统概述
- 多设备访问的详细指南
- 搜索技巧的完整说明
- 照片展示区的使用指南
- 用户配置管理的详细说明
- API密钥配置的完整流程
- 常见问题解答
